---
title: "exploratory_personality_with_MI"
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
date: "2023-03-29"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

```{r clear environment, echo = FALSE}
rm(list = ls())
```


```{r libraries, message = FALSE, warning = FALSE, include = FALSE}
library(Rmisc)
library(Hmisc)
library(rio)
library(tidyverse)
library(psych)
library(gtools) # rbinding data frames
library(corrplot)
library(jtools) # for pretty printing tables
library(sjPlot) # pretty printing tables
library(sjmisc) # pretty printing
library(mice) # handling missing values
library(naniar) # visualizaing missingness & MCAR test
library(miceadds) # for mi.anova
library(emmeans) # simple effects analyses
library(broom)     # for extracting residuals and outlier indices
library(olsrr)     # for creating outlier plots
library(smcfcs) # for multiple imputation with interactions
library(mitools) # for pooling MI results
library(marginaleffects) # for plotting marginal means 
library(installr)
library(epiDisplay) # for frequency tables

options(max.print = 100000) # max rows to print in output
options(scipen = 1000) # turn off sci notation
```

# Data Import & Cleaning

## Import data
```{r import data}
raw_psych_hum_subj <- import("data/raw/raw_psych_hum_subj.csv")
raw_mktg_hum_subj <- import("data/raw/raw_mktg_hum_subj.csv")
raw_gen_uo_pop <- import("data/raw/raw_gen_uo_pop.csv")
pre_fall22 <- import("data/prescreen/dittersdorf_matches_f22.csv")
pre_winter23 <- import("data/prescreen/dittersdorf_matches_w23.csv")
pre_spring23 <- import("data/prescreen/dittersdorf_matches_s23.csv")
participant_list <- import("data/prescreen/dittersdorf_participants.csv")
```



Fix age before converting variable types
```{r}
table(raw_psych_hum_subj$Age) # 18 years old = 18
table(raw_mktg_hum_subj$Age) # 1999 = 24
table(raw_gen_uo_pop$Age)

raw_psych_hum_subj$Age[raw_psych_hum_subj$Age == "18 years old"] <- 18
raw_mktg_hum_subj$Age[raw_mktg_hum_subj$Age == 1999] <- 24

table(raw_psych_hum_subj$Age) # 18 years old = 18
table(raw_mktg_hum_subj$Age) # 1999 = 24
```



## Combine dataframes 
```{r update var types, warning = FALSE}
raw_psych_hum_subj <- raw_psych_hum_subj %>%
  mutate(Age = as.integer(Age),
         Gender = as.factor(Gender),
         framing_condition_DO = as.factor(framing_condition_DO),
         norm_condition_DO = as.factor(norm_condition_DO),
         consumer_behaviors = as.factor(consumer_behaviors),
         skepticism = as.factor(skepticism),
         id = as.factor(id),
         source = strrep("psych_hsp", times = 1))

raw_mktg_hum_subj <- raw_mktg_hum_subj %>%
  mutate(Age = as.integer(Age),
         Gender = as.factor(Gender),
         Gender_5_TEXT = as.character(Gender_5_TEXT),
         Class_Lvl_7_TEXT = as.character(Class_Lvl_7_TEXT),
         Pol_Ornt_8_TEXT = as.character(Pol_Ornt_8_TEXT),
         Ethnicity_8_TEXT = as.character(Ethnicity_8_TEXT),
         skept_open = as.character(skept_open),
         skepticism = as.factor(skepticism),
         id = as.factor(id),
         framing_condition_DO = as.factor(framing_condition_DO),
         norm_condition_DO = as.factor(norm_condition_DO),
         consumer_behaviors = as.factor(consumer_behaviors),
         source = strrep("mktg_hsp", times = 1))

raw_gen_uo_pop <- raw_gen_uo_pop %>%
  mutate(Gender = as.factor(Gender),
         Gender_5_TEXT = as.character(Gender_5_TEXT),
         Class_Lvl_7_TEXT = as.character(Class_Lvl_7_TEXT),
         Pol_Ornt_8_TEXT = as.character(Pol_Ornt_8_TEXT),
         skept_open = as.character(skept_open),
         skepticism = as.factor(skepticism),
         id = as.factor(id),
         framing_condition_DO = as.factor(framing_condition_DO),
         norm_condition_DO = as.factor(norm_condition_DO),
         consumer_behaviors = as.factor(consumer_behaviors),
         source = strrep("gen_UO", times = 1))
```


Specify unique variables to combine prescreen data sets
```{r prep prescreen dfs}
# Create unique full_name variable
pre_fall22$full_name <- paste(pre_fall22$first_name, pre_fall22$last_name, sep="_")

pre_winter23$full_name <- paste(pre_winter23$first_name, pre_winter23$last_name, sep="_")

pre_spring23$full_name <- paste(pre_spring23$first_name, pre_spring23$last_name, sep="_")

participant_list$full_name <- paste(participant_list$first_name, participant_list$last_name, sep="_")

# Create column indicating which data set rows came from

pre_fall22 <- pre_fall22 %>%
  mutate(term = "fall22")

pre_winter23 <- pre_winter23 %>%
  mutate(term = "winter23")

pre_spring23 <- pre_spring23 %>%
  mutate(term = "spring23")
```


Combine prescreen data
```{r combine prescreen dfs}
combine1 <- smartbind(pre_fall22, pre_winter23)
combined_prescreen <- smartbind(combine1, pre_spring23)

# nrow(pre_fall22) + nrow(pre_winter23) + nrow(pre_spring23) # n = 1167

combined_prescreen_unique <- combined_prescreen[!duplicated(combined_prescreen$full_name), ] # keeps first row (fall22)
```

Subset key variables
```{r subset key vars}
combined_prescreen_key <- combined_prescreen_unique %>%
  dplyr::select(full_name, term, respecting:gratification, honest:gossip)

participant_list_key <- participant_list %>%
  dplyr::select(full_name, survey_id)
```

Merge with participant list
```{r merge participant list}
merged_prescreen <- merge(combined_prescreen_key, participant_list_key, by = "full_name")
```


Rename SDR items to match
```{r clean merged prescreen, warning = FALSE, include = FALSE}
merged_prescreen <- merged_prescreen %>%
  rename("lose_out" = "lose-out", 
         "cover_up" = "cover-up",
         "get_even" = "get-even",
         "behind_back" = "behind-back",
         "private_talk" = "private-talk",
         "take_things" = "take-things",
         "id" = "survey_id")
```

Convert variable types
```{r}
merged_prescreen <- merged_prescreen %>%
  mutate(respecting = as.integer(respecting),
         unity = as.integer(unity),
         protecting = as.integer(protecting),
         preventing = as.integer(preventing),
         equality = as.integer(equality),
         peace = as.integer(peace),
         justice = as.integer(justice),
         helpful = as.integer(helpful),
         power = as.integer(power),
         wealth = as.integer(wealth),
         authority = as.integer(authority),
         influential = as.integer(influential),
         ambition = as.integer(ambition),
         pleasures = as.integer(pleasures),
         enjoying = as.integer(enjoying),
         gratification = as.integer(gratification),
         honest = as.integer(honest),
         like = as.integer(like),
         disturbing = as.integer(disturbing),
         regret = as.integer(regret),
         lose_out = as.integer(lose_out),
         rational = as.integer(rational),
         confident = as.integer(confident),
         lover = as.integer(lover),
         lies = as.integer(lies),
         cover_up = as.integer(cover_up),
         advantage = as.integer(advantage),
         get_even = as.integer(get_even),
         behind_back = as.integer(behind_back),
         private_talk = as.integer(private_talk),
         take_things = as.integer(take_things),
         gossip = as.integer(gossip),
         id = as.factor(id))
```


Rename values & socially desirable items in prescreen data to match names in main data:
```{r rename prescreen vars, include = FALSE}
merged_prescreen <- merged_prescreen %>%
  rename("values_1" = "respecting",
         "values_2" = "unity",
         "values_3" = "protecting",
         "values_4" = "preventing",
         "values_5" = "equality",
         "values_6" = "peace",
         "values_7" = "justice",
         "values_8" = "helpful",
         "values_9" = "power",
         "values_10" = "wealth",
         "values_11" = "authority",
         "values_12" = "influential",
         "values_13" = "ambition",
         "values_14" = "pleasures",
         "values_15" = "enjoying",
         "values_16" = "gratification",
         "socially_desirable_1" = "honest",
         "socially_desirable_2" = "like",
         "socially_desirable_3" = "disturbing",
         "socially_desirable_4" = "regret",
         "socially_desirable_5" = "lose_out",
         "socially_desirable_6" = "rational",
         "socially_desirable_7" = "confident",
         "socially_desirable_8" = "lover",
         "socially_desirable_9" = "lies",
         "socially_desirable_10" = "cover_up",
         "socially_desirable_11" = "advantage",
         "socially_desirable_12" = "get_even",
         "socially_desirable_13" = "behind_back",
         "socially_desirable_14" = "private_talk",
         "socially_desirable_15" = "take_things",
         "socially_desirable_16" = "gossip")
```


Combine all data

- First, combine Psych Hum Subj data with Prescreen data based on `id`
- Second, add Mktg Hum Subj data
- Third, add gen UO Pop data
```{r combine all data}
combine1 <- merge(raw_psych_hum_subj, merged_prescreen, by = "id")
combine2 <- smartbind(combine1, raw_mktg_hum_subj)
combine3 <- smartbind(combine2, raw_gen_uo_pop)
```


## Remove duplicate cases

Identify duplicate cases
```{r id duplicate cases, results = 'hide'}
# first, add unique row #s
combine3 <- combine3 %>%
  mutate(row = 1:nrow(combine3))

combine3[duplicated(combine3$id),] # Only rows 1 through 858 have unique id #s

# write.csv(combine3, "combined_data.csv")
```

Row IDs to remove:

* 13 (participant's second time completing study)
* 134 (participant didn't complete study first time)
* 145 (participant didn't complete study first time)
* 308 (participant's second time completing study)
* 672 (participant's second time completing study)
* 743 (participant didn't complete study first time)
* 790 (participant didn't complete study first time)
* 800 (participant didn't complete study first time)

Remove duplicate rows after resolving:
```{r remove duplicate cases}
combine3 <- combine3 %>%
  filter(!row %in% c(13, 134, 145, 308, 672, 743, 790, 800))
```


## Remove rows of all NAs

Identify completely missing rows:
```{r id all NA rows, results = 'hide'}
key_vars <- combine3 %>%
  dplyr::select(row, big_2_1:big_2_65, consumer_intentions_1:consumer_intentions_9, consumer_behaviors, clothing_interest_1:clothing_interest_20, ingroup_ident_1:ingroup_ident_14, values_1:values_16, socially_desirable_1:socially_desirable_16, source)

ncol(key_vars) # number of columns - the row # & source column = 141

all_NA_rows <- key_vars[rowSums(is.na(key_vars)) == 141,] # identify rows with 141 NAs (all missing values), row numbers are preserved

all_NA_rows
```

Removing rows of fully missing data
```{r remove all NA rows}
data <- combine3 %>%
  dplyr::filter(!row %in% c(859, 860, 900, 926, 927, 941, 1139, 1141, 1142, 1143, 1144, 1146, 1149, 1150, 1152)) %>% # remove rows containing all NAs
  dplyr::select(-StartDate, -EndDate, -Status, -Progress, -"Duration (in seconds)", -Finished, -RecordedDate, -ResponseId, -DistributionChannel, -UserLanguage, -big_2_DO, -consumer_intentions_DO, -consumer_behaviors_DO, -clothing_interest_DO, -ingroup_ident_DO, -full_name, -code, -socially_desirable_DO, -values_DO, -email_giftcard, -term) # removing variables not in analysis
```


## Number per source
```{r}
table(data$source)
```

* 850 = psych human subjects pool
* 276 = mktg human subjects pool
* 7 = general UO pop


Rename variables
```{r rename vars}
data <- data %>%
  rename("framing_condition" = "framing_condition_DO", 
         "norm_condition" = "norm_condition_DO")
```

Drop unused levels
```{r include = FALSE}
levels(data$framing_condition)
levels(data$norm_condition)

data$framing_condition <- droplevels(data$framing_condition)
data$norm_condition <- droplevels(data$norm_condition)

levels(data$framing_condition)
levels(data$norm_condition)
```

## Inspect final data 
```{r inspect final df, results = 'hide'}
str(data, list.len = ncol(data))

# write.csv(data, "final_data.csv")
```


# Aggregate Variables 

## Personality

### Reverse-code

```{r reverse personality items}
data_R <- data %>%
  mutate(across(c(big_2_11,
                  big_2_16,
                  big_2_26,
                  big_2_31,
                  big_2_36,
                  big_2_51,
                  big_2_12,
                  big_2_17,
                  big_2_22,
                  big_2_37,
                  big_2_42,
                  big_2_47,
                  big_2_3,
                  big_2_8,
                  big_2_23,
                  big_2_28,
                  big_2_48,
                  big_2_58,
                  big_2_4,
                  big_2_9,
                  big_2_24,
                  big_2_29,
                  big_2_44,
                  big_2_49,
                  big_2_5,
                  big_2_25,
                  big_2_30,
                  big_2_45,
                  big_2_50,
                  big_2_55,
                  big_2_63), ~6 - .)) # replace '6' with the max possible value plus 1 for any particular scale
```

### Average items

```{r aggregate personality}
data_R$extraversion <- data_R %>%
  dplyr::select(big_2_1, big_2_6, big_2_11, big_2_16, big_2_21, big_2_26, big_2_31, big_2_36, big_2_41, big_2_46, big_2_51, big_2_56) %>%
  rowMeans(na.rm = TRUE) 


data_R$conscientiousness <- data_R %>%
  dplyr::select(big_2_3, big_2_8, big_2_13, big_2_18, big_2_23, big_2_28, big_2_33, big_2_38, big_2_43, big_2_48, big_2_53, big_2_58) %>%
  rowMeans(na.rm = TRUE)


data_R$agreeableness <- data_R %>%
  dplyr::select(big_2_2, big_2_7, big_2_12, big_2_17, big_2_22, big_2_27, big_2_32, big_2_37, big_2_42, big_2_47, big_2_52, big_2_57) %>%
  rowMeans(na.rm = TRUE)


data_R$neuroticism <- data_R %>%
  dplyr::select(big_2_4, big_2_9, big_2_14, big_2_19, big_2_24, big_2_29, big_2_34, big_2_39, big_2_44, big_2_49, big_2_54, big_2_59) %>%
  rowMeans(na.rm = TRUE)


data_R$openness <- data_R %>%
  dplyr::select(big_2_5, big_2_10, big_2_15, big_2_20, big_2_25, big_2_30, big_2_35, big_2_40, big_2_45, big_2_50, big_2_55, big_2_60) %>%
  rowMeans(na.rm = TRUE)


data_R$honesty <- data_R %>%
  dplyr::select(big_2_61, big_2_62, big_2_63, big_2_64, big_2_65) %>%
  rowMeans(na.rm = TRUE)
```

### Visually inspect
```{r warning = FALSE}
data_R %>%
  dplyr::select(extraversion, agreeableness, conscientiousness, openness, neuroticism, honesty) %>%
  hist()
```


## Clothing Interest

### Reverse-code

```{r reverse clothing items}
data_R <- data_R %>%
  mutate(across(c(clothing_interest_3,
                  clothing_interest_5,
                  clothing_interest_7,
                  clothing_interest_9,
                  clothing_interest_12,
                  clothing_interest_14,
                  clothing_interest_15,
                  clothing_interest_16,
                  clothing_interest_18,
                  clothing_interest_20), ~6 - .)) # replace '#' with the max possible value plus 1 for any particular scale
```


### Average items
```{r aggregate clothing interest}
data_R$clothing_interest <- data_R %>%
  dplyr::select(clothing_interest_1:clothing_interest_20) %>%
  rowMeans(na.rm = TRUE)
```



## In-group Identification

### Reverse-code

No items need to be reverse-coded.

### Average items
```{r aggegate ingroup ident}
data_R$ingroup_identification <- data_R %>%
  dplyr::select(ingroup_ident_1:ingroup_ident_14) %>%
  rowMeans(na.rm = TRUE)
```


## Values

### Reverse-code

No items need to be reverse-coded.

### Recoding scale options

Recoding values:

* -3 = 1
* -2 = 2
* -1 = 3
* 0 = 4
* +1 = 5
* +2 = 6
* +3 = 7

```{r recode values}
table(data_R$values_1)

data_R$values_1_rec <- recode(data_R$values_1, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)

table(data_R$values_1_rec)

data_R$values_2_rec <- recode(data_R$values_2, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_3_rec <- recode(data_R$values_3, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_4_rec <- recode(data_R$values_4, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_5_rec <- recode(data_R$values_5, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_6_rec <- recode(data_R$values_6, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_7_rec <- recode(data_R$values_7, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_8_rec <- recode(data_R$values_8, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_9_rec <- recode(data_R$values_9, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_10_rec <- recode(data_R$values_10, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_11_rec <- recode(data_R$values_11, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_12_rec <- recode(data_R$values_12, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_13_rec <- recode(data_R$values_13, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_14_rec <- recode(data_R$values_14, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_15_rec <- recode(data_R$values_15, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_16_rec <- recode(data_R$values_16, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)

table(data_R$values_16)
table(data_R$values_16_rec)
```


### Average items
```{r aggregate values}
data_R$biospheric <- data_R %>%
  dplyr::select(values_1_rec:values_4_rec) %>%
  rowMeans(na.rm = TRUE)

data_R$altruistic <- data_R %>%
  dplyr::select(values_5_rec:values_8_rec) %>%
  rowMeans(na.rm = TRUE)

data_R$egoistic <- data_R %>%
  dplyr::select(values_9_rec:values_13_rec) %>%
  rowMeans(na.rm = TRUE)

data_R$hedonic <- data_R %>%
  dplyr::select(values_14_rec:values_16_rec) %>%
  rowMeans(na.rm = TRUE)
```


### Frequency tables
```{r}
# Biospheric values
tab1(values_df$biospheric, sort.group = "descending", cum.percent = TRUE, missing = FALSE, horiz = TRUE)

# Altruistic values
tab1(values_df$altruistic, sort.group = "descending", cum.percent = TRUE, missing = FALSE, horiz = TRUE)

# Egoistic values
tab1(values_df$egoistic, sort.group = "descending", cum.percent = TRUE, missing = FALSE, horiz = TRUE)

# Hedonic values
tab1(values_df$hedonic, sort.group = "descending", cum.percent = TRUE, missing = FALSE, horiz = TRUE)
```




## Socially Desirable Responding

### Reverse-code
```{r reverse code socially desirable items}
data_R <- data_R %>%
  mutate(across(c(socially_desirable_1,
                  socially_desirable_3,
                  socially_desirable_5,
                  socially_desirable_8,
                  socially_desirable_9,
                  socially_desirable_11,
                  socially_desirable_12,
                  socially_desirable_13), ~8 - .)) # replace '#' with the max possible value plus 1 for any particular scale
```

### Average items
```{r aggregate socially desirable}
data_R$self_deceptive_sdr <- data_R %>%
  dplyr::select(socially_desirable_1:socially_desirable_8) %>%
  rowMeans(na.rm = TRUE)
  
data_R$impress_manag_sdr <- data_R %>%
  dplyr::select(socially_desirable_9:socially_desirable_16) %>%
  rowMeans(na.rm = TRUE)
```



## Consumer Intentions

### Reverse-code

Higher scores mean better consumer intentions (intentions to *reduce* future consumption):
```{r reverse code consumer intentions}
data_R <- data_R %>%
  mutate(across(c(consumer_intentions_2,
                  consumer_intentions_4,
                  consumer_intentions_7,
                  consumer_intentions_9), ~8 - .)) # replace '#' with the max possible value plus 1 for any particular scale
```

### Average items

```{r aggregate consumer intentions}
data_R$consumer_intentions <- data_R %>%
  dplyr::select(consumer_intentions_1:consumer_intentions_9) %>%
  rowMeans(na.rm = TRUE)
```

### Visually inspect

```{r warning = FALSE}
data_R %>%
  dplyr::select(consumer_intentions) %>%
  hist()
```


### Reorder levels

Reorder the levels of norm condition:
```{r reorder norm condition levels}
data_R %>%
  group_by(norm_condition) %>%
  summarize(M = mean(consumer_intentions, na.rm = TRUE))

data_R$norm_condition <- factor(data_R$norm_condition, levels = c("control_norm", "descriptive_norm", "convention_norm", "social_norm", "moral_norm"))
```



# Regression Analysis (DV = Consumer Intentions)

```{r include = FALSE}
# library(haven)
# write_sav(data_R, "combined_clean_data.sav") 
```


## Contrast Coding 

Subset variables
```{r echo = FALSE}
data_R_alt <- data_R %>%
  dplyr::select(hedonic, egoistic, altruistic, biospheric, ingroup_identification, Age, clothing_interest, self_deceptive_sdr, impress_manag_sdr, consumer_intentions, consumer_behaviors, Gender, framing_condition, norm_condition, extraversion, conscientiousness, agreeableness, openness, neuroticism, honesty)
```


Contrast Coding using ifelse() approach:
```{r alt coding}
# Framing
data_R_alt$FramingCode1 <- ifelse(data_R_alt$framing_condition == "control_framing", -1/2, ifelse(data_R_alt$framing_condition == "self_enh_framing", 1/2, 0))

data_R_alt$FramingCode2 <- ifelse(data_R_alt$framing_condition == "pro_env_framing", 2/3, -1/3)


# Norm
data_R_alt$NormCode1 <- ifelse(data_R_alt$norm_condition == "moral_norm", 4, -1)

data_R_alt$NormCode2 <- ifelse(data_R_alt$norm_condition == "social_norm", 3, ifelse(data_R_alt$norm_condition == "moral_norm", 0, -1))

data_R_alt$NormCode3 <- ifelse(data_R_alt$norm_condition == "convention_norm", 2, ifelse(data_R_alt$norm_condition == "moral_norm", 0, ifelse(data_R_alt$norm_condition == "social_norm", 0, -1)))
data_R_alt$NormCode4 <- ifelse(data_R_alt$norm_condition == "descriptive_norm", 1, ifelse(data_R_alt$norm_condition == "control_norm", -1, 0))


## Adding contrast codes to Framing & Norm Condition
# Framing
FrameCode1 <- c(-1/2, 0, 1/2) # control vs self-enhancing
FrameCode2 <- c(-1/3, 2/3, -1/3) # arbitrary code

contrasts(data_R_alt$framing_condition) <- cbind(FrameCode1, FrameCode2)
contrasts(data_R_alt$framing_condition)

# Norm
contrasts(data_R_alt$norm_condition) <- contr.helmert(5)
contrasts(data_R_alt$norm_condition) # control vs DN

# Gender
levels(data_R_alt$Gender) <- c("Woman", "Man", "Non-binary", "I prefer not to identify", "Other")

data_R_alt$Gender[data_R_alt$Gender == "Non-binary"] <- NA
data_R_alt$Gender[data_R_alt$Gender == "I prefer not to identify"] <- NA
data_R_alt$Gender[data_R_alt$Gender == "Other"] <- NA

data_R_alt$Gender <- droplevels(data_R_alt$Gender)

contrasts(data_R_alt$Gender) <- c(1, 0)
levels(data_R_alt$Gender)
```


## Multiple Imputation 

### Full Model

Examine missingness:
```{r}
data_R_alt %>%
  vis_miss()

sapply(data_R_alt, function(x) sum(is.na(x)))
```

Variables with NO missing data:

* ingroup_identification
* clothing_interest
* consumer_intentions
* framing_condition
* norm_condition


Adding interaction terms
```{r include = FALSE}
data_R_alt <- data_R_alt %>%
  mutate(framing1Xbiospheric = (FramingCode1)*(biospheric),
         framing2Xbiospheric = (FramingCode2)*(biospheric),
         norm1Xbiospheric = (NormCode1)*(biospheric),
         norm2Xbiospheric = (NormCode2)*(biospheric),
         norm3Xbiospheric = (NormCode3)*(biospheric),
         norm4Xbiospheric = (NormCode4)*(biospheric),
         framing1Xnorm1Xbiospheric = (FramingCode1)*(NormCode1)*(biospheric),
         framing1Xnorm2Xbiospheric = (FramingCode1)*(NormCode2)*(biospheric),
         framing1Xnorm3Xbiospheric = (FramingCode1)*(NormCode3)*(biospheric),
         framing1Xnorm4Xbiospheric = (FramingCode1)*(NormCode4)*(biospheric),
         framing2Xnorm1Xbiospheric = (FramingCode2)*(NormCode1)*(biospheric),
         framing2Xnorm2Xbiospheric = (FramingCode2)*(NormCode2)*(biospheric),
         framing2Xnorm3Xbiospheric = (FramingCode2)*(NormCode3)*(biospheric),
         framing2Xnorm4Xbiospheric = (FramingCode2)*(NormCode4)*(biospheric),
         
         framing1Xaltruistic = (FramingCode1)*(altruistic),
         framing2Xaltruistic = (FramingCode2)*(altruistic),
         norm1Xaltruistic = (NormCode1)*(altruistic),
         norm2Xaltruistic = (NormCode2)*(altruistic),
         norm3Xaltruistic = (NormCode3)*(altruistic),
         norm4Xaltruistic = (NormCode4)*(altruistic),
         framing1Xnorm1Xaltruistic = (FramingCode1)*(NormCode1)*(altruistic),
         framing1Xnorm2Xaltruistic = (FramingCode1)*(NormCode2)*(altruistic),
         framing1Xnorm3Xaltruistic = (FramingCode1)*(NormCode3)*(altruistic),
         framing1Xnorm4Xaltruistic = (FramingCode1)*(NormCode4)*(altruistic),
         framing2Xnorm1Xaltruistic = (FramingCode2)*(NormCode1)*(altruistic),
         framing2Xnorm2Xaltruistic = (FramingCode2)*(NormCode2)*(altruistic),
         framing2Xnorm3Xaltruistic = (FramingCode2)*(NormCode3)*(altruistic),
         framing2Xnorm4Xaltruistic = (FramingCode2)*(NormCode4)*(altruistic),
         
         framing1Xegoistic = (FramingCode1)*(egoistic),
         framing2Xegoistic = (FramingCode2)*(egoistic),
         norm1Xegoistic = (NormCode1)*(egoistic),
         norm2Xegoistic = (NormCode2)*(egoistic),
         norm3Xegoistic = (NormCode3)*(egoistic),
         norm4Xegoistic = (NormCode4)*(egoistic),
         framing1Xnorm1Xegoistic = (FramingCode1)*(NormCode1)*(egoistic),
         framing1Xnorm2Xegoistic = (FramingCode1)*(NormCode2)*(egoistic),
         framing1Xnorm3Xegoistic = (FramingCode1)*(NormCode3)*(egoistic),
         framing1Xnorm4Xegoistic = (FramingCode1)*(NormCode4)*(egoistic),
         framing2Xnorm1Xegoistic = (FramingCode2)*(NormCode1)*(egoistic),
         framing2Xnorm2Xegoistic = (FramingCode2)*(NormCode2)*(egoistic),
         framing2Xnorm3Xegoistic = (FramingCode2)*(NormCode3)*(egoistic),
         framing2Xnorm4Xegoistic = (FramingCode2)*(NormCode4)*(egoistic),
         
         framing1Xhedonic = (FramingCode1)*(hedonic),
         framing2Xhedonic = (FramingCode2)*(hedonic),
         norm1Xhedonic = (NormCode1)*(hedonic),
         norm2Xhedonic = (NormCode2)*(hedonic),
         norm3Xhedonic = (NormCode3)*(hedonic),
         norm4Xhedonic = (NormCode4)*(hedonic),
         framing1Xnorm1Xhedonic = (FramingCode1)*(NormCode1)*(hedonic),
         framing1Xnorm2Xhedonic = (FramingCode1)*(NormCode2)*(hedonic),
         framing1Xnorm3Xhedonic = (FramingCode1)*(NormCode3)*(hedonic),
         framing1Xnorm4Xhedonic = (FramingCode1)*(NormCode4)*(hedonic),
         framing2Xnorm1Xhedonic = (FramingCode2)*(NormCode1)*(hedonic),
         framing2Xnorm2Xhedonic = (FramingCode2)*(NormCode2)*(hedonic),
         framing2Xnorm3Xhedonic = (FramingCode2)*(NormCode3)*(hedonic),
         framing2Xnorm4Xhedonic = (FramingCode2)*(NormCode4)*(hedonic),
         
         framing1Xingroup = (FramingCode1)*(ingroup_identification),
         framing2Xingroup = (FramingCode2)*(ingroup_identification),
         norm1Xingroup = (NormCode1)*(ingroup_identification),
         norm2Xingroup = (NormCode2)*(ingroup_identification),
         norm3Xingroup = (NormCode3)*(ingroup_identification),
         norm4Xingroup = (NormCode4)*(ingroup_identification),
         framing1Xnorm1Xingroup = (FramingCode1)*(NormCode1)*(ingroup_identification),
         framing1Xnorm2Xingroup = (FramingCode1)*(NormCode2)*(ingroup_identification),
         framing1Xnorm3Xingroup = (FramingCode1)*(NormCode3)*(ingroup_identification),
         framing1Xnorm4Xingroup = (FramingCode1)*(NormCode4)*(ingroup_identification),
         framing2Xnorm1Xingroup = (FramingCode2)*(NormCode1)*(ingroup_identification),
         framing2Xnorm2Xingroup = (FramingCode2)*(NormCode2)*(ingroup_identification),
         framing2Xnorm3Xingroup = (FramingCode2)*(NormCode3)*(ingroup_identification),
         framing2Xnorm4Xingroup = (FramingCode2)*(NormCode4)*(ingroup_identification),
         
         framing1Xextraversion = (FramingCode1)*(extraversion),
         framing2Xextraversion = (FramingCode2)*(extraversion),
         norm1Xextraversion = (NormCode1)*(extraversion),
         norm2Xextraversion = (NormCode2)*(extraversion),
         norm3Xextraversion = (NormCode3)*(extraversion),
         norm4Xextraversion = (NormCode4)*(extraversion),
         framing1Xnorm1Xextraversion = (FramingCode1)*(NormCode1)*(extraversion),
         framing1Xnorm2Xextraversion = (FramingCode1)*(NormCode2)*(extraversion),
         framing1Xnorm3Xextraversion = (FramingCode1)*(NormCode3)*(extraversion),
         framing1Xnorm4Xextraversion = (FramingCode1)*(NormCode4)*(extraversion),
         framing2Xnorm1Xextraversion = (FramingCode2)*(NormCode1)*(extraversion),
         framing2Xnorm2Xextraversion = (FramingCode2)*(NormCode2)*(extraversion),
         framing2Xnorm3Xextraversion = (FramingCode2)*(NormCode3)*(extraversion),
         framing2Xnorm4Xextraversion = (FramingCode2)*(NormCode4)*(extraversion),
         
         framing1Xconscientiousness = (FramingCode1)*(conscientiousness),
         framing2Xconscientiousness = (FramingCode2)*(conscientiousness),
         norm1Xconscientiousness = (NormCode1)*(conscientiousness),
         norm2Xconscientiousness = (NormCode2)*(conscientiousness),
         norm3Xconscientiousness = (NormCode3)*(conscientiousness),
         norm4Xconscientiousness = (NormCode4)*(conscientiousness),
         framing1Xnorm1Xconscientiousness = (FramingCode1)*(NormCode1)*(conscientiousness),
         framing1Xnorm2Xconscientiousness = (FramingCode1)*(NormCode2)*(conscientiousness),
         framing1Xnorm3Xconscientiousness = (FramingCode1)*(NormCode3)*(conscientiousness),
         framing1Xnorm4Xconscientiousness = (FramingCode1)*(NormCode4)*(conscientiousness),
         framing2Xnorm1Xconscientiousness = (FramingCode2)*(NormCode1)*(conscientiousness),
         framing2Xnorm2Xconscientiousness = (FramingCode2)*(NormCode2)*(conscientiousness),
         framing2Xnorm3Xconscientiousness = (FramingCode2)*(NormCode3)*(conscientiousness),
         framing2Xnorm4Xconscientiousness = (FramingCode2)*(NormCode4)*(conscientiousness),
         
         framing1Xagreeableness = (FramingCode1)*(agreeableness),
         framing2Xagreeableness = (FramingCode2)*(agreeableness),
         norm1Xagreeableness = (NormCode1)*(agreeableness),
         norm2Xagreeableness = (NormCode2)*(agreeableness),
         norm3Xagreeableness = (NormCode3)*(agreeableness),
         norm4Xagreeableness = (NormCode4)*(agreeableness),
         framing1Xnorm1Xagreeableness = (FramingCode1)*(NormCode1)*(agreeableness),
         framing1Xnorm2Xagreeableness = (FramingCode1)*(NormCode2)*(agreeableness),
         framing1Xnorm3Xagreeableness = (FramingCode1)*(NormCode3)*(agreeableness),
         framing1Xnorm4Xagreeableness = (FramingCode1)*(NormCode4)*(agreeableness),
         framing2Xnorm1Xagreeableness = (FramingCode2)*(NormCode1)*(agreeableness),
         framing2Xnorm2Xagreeableness = (FramingCode2)*(NormCode2)*(agreeableness),
         framing2Xnorm3Xagreeableness = (FramingCode2)*(NormCode3)*(agreeableness),
         framing2Xnorm4Xagreeableness = (FramingCode2)*(NormCode4)*(agreeableness),
         
         framing1Xopenness = (FramingCode1)*(openness),
         framing2Xopenness = (FramingCode2)*(openness),
         norm1Xopenness = (NormCode1)*(openness),
         norm2Xopenness = (NormCode2)*(openness),
         norm3Xopenness = (NormCode3)*(openness),
         norm4Xopenness = (NormCode4)*(openness),
         framing1Xnorm1Xopenness = (FramingCode1)*(NormCode1)*(openness),
         framing1Xnorm2Xopenness = (FramingCode1)*(NormCode2)*(openness),
         framing1Xnorm3Xopenness = (FramingCode1)*(NormCode3)*(openness),
         framing1Xnorm4Xopenness = (FramingCode1)*(NormCode4)*(openness),
         framing2Xnorm1Xopenness = (FramingCode2)*(NormCode1)*(openness),
         framing2Xnorm2Xopenness = (FramingCode2)*(NormCode2)*(openness),
         framing2Xnorm3Xopenness = (FramingCode2)*(NormCode3)*(openness),
         framing2Xnorm4Xopenness = (FramingCode2)*(NormCode4)*(openness),
         
         framing1Xneuroticism = (FramingCode1)*(neuroticism),
         framing2Xneuroticism = (FramingCode2)*(neuroticism),
         norm1Xneuroticism = (NormCode1)*(neuroticism),
         norm2Xneuroticism = (NormCode2)*(neuroticism),
         norm3Xneuroticism = (NormCode3)*(neuroticism),
         norm4Xneuroticism = (NormCode4)*(neuroticism),
         framing1Xnorm1Xneuroticism = (FramingCode1)*(NormCode1)*(neuroticism),
         framing1Xnorm2Xneuroticism = (FramingCode1)*(NormCode2)*(neuroticism),
         framing1Xnorm3Xneuroticism = (FramingCode1)*(NormCode3)*(neuroticism),
         framing1Xnorm4Xneuroticism = (FramingCode1)*(NormCode4)*(neuroticism),
         framing2Xnorm1Xneuroticism = (FramingCode2)*(NormCode1)*(neuroticism),
         framing2Xnorm2Xneuroticism = (FramingCode2)*(NormCode2)*(neuroticism),
         framing2Xnorm3Xneuroticism = (FramingCode2)*(NormCode3)*(neuroticism),
         framing2Xnorm4Xneuroticism = (FramingCode2)*(NormCode4)*(neuroticism),
         
         framing1Xhonesty = (FramingCode1)*(honesty),
         framing2Xhonesty = (FramingCode2)*(honesty),
         norm1Xhonesty = (NormCode1)*(honesty),
         norm2Xhonesty = (NormCode2)*(honesty),
         norm3Xhonesty = (NormCode3)*(honesty),
         norm4Xhonesty = (NormCode4)*(honesty),
         framing1Xnorm1Xhonesty = (FramingCode1)*(NormCode1)*(honesty),
         framing1Xnorm2Xhonesty = (FramingCode1)*(NormCode2)*(honesty),
         framing1Xnorm3Xhonesty = (FramingCode1)*(NormCode3)*(honesty),
         framing1Xnorm4Xhonesty = (FramingCode1)*(NormCode4)*(honesty),
         framing2Xnorm1Xhonesty = (FramingCode2)*(NormCode1)*(honesty),
         framing2Xnorm2Xhonesty = (FramingCode2)*(NormCode2)*(honesty),
         framing2Xnorm3Xhonesty = (FramingCode2)*(NormCode3)*(honesty),
         framing2Xnorm4Xhonesty = (FramingCode2)*(NormCode4)*(honesty))
```



Imputation model

```{r}
set.seed(114950518)
```

- check out mice.impute.smcfcs 

```{r echo = FALSE}
imps <- smcfcs(data_R_alt, 
               smtype = "lm", 
               smformula = "consumer_intentions ~ framing_condition + norm_condition + framing_condition*norm_condition + biospheric + altruistic + egoistic + hedonic + ingroup_identification + clothing_interest + self_deceptive_sdr + impress_manag_sdr + Age + Gender + extraversion + conscientiousness + agreeableness + openness + neuroticism + honesty + framing1Xbiospheric + framing2Xbiospheric + norm1Xbiospheric + norm2Xbiospheric + norm3Xbiospheric + norm4Xbiospheric + framing1Xnorm1Xbiospheric + framing1Xnorm2Xbiospheric + framing1Xnorm3Xbiospheric + framing1Xnorm4Xbiospheric + framing2Xnorm1Xbiospheric + framing2Xnorm2Xbiospheric + framing2Xnorm3Xbiospheric + framing2Xnorm4Xbiospheric + framing1Xaltruistic + framing2Xaltruistic + norm1Xaltruistic + norm2Xaltruistic + norm3Xaltruistic + norm4Xaltruistic + framing1Xnorm1Xaltruistic + framing1Xnorm2Xaltruistic + framing1Xnorm3Xaltruistic + framing1Xnorm4Xaltruistic + framing2Xnorm1Xaltruistic + framing2Xnorm2Xaltruistic + framing2Xnorm3Xaltruistic + framing2Xnorm4Xaltruistic + framing1Xegoistic + framing2Xegoistic + norm1Xegoistic + norm2Xegoistic + norm3Xegoistic + norm4Xegoistic + framing1Xnorm1Xegoistic + framing1Xnorm2Xegoistic + framing1Xnorm3Xegoistic + framing1Xnorm4Xegoistic + framing2Xnorm1Xegoistic + framing2Xnorm2Xegoistic + framing2Xnorm3Xegoistic + framing2Xnorm4Xegoistic + framing1Xhedonic + framing2Xhedonic + norm1Xhedonic + norm2Xhedonic + norm3Xhedonic + norm4Xhedonic + framing1Xnorm1Xhedonic + framing1Xnorm2Xhedonic + framing1Xnorm3Xhedonic + framing1Xnorm4Xhedonic + framing2Xnorm1Xhedonic + framing2Xnorm2Xhedonic + framing2Xnorm3Xhedonic + framing2Xnorm4Xhedonic + framing1Xingroup + framing2Xingroup + norm1Xingroup + norm2Xingroup + norm3Xingroup + norm4Xingroup + framing1Xnorm1Xingroup + framing1Xnorm2Xingroup + framing1Xnorm3Xingroup + framing1Xnorm4Xingroup + framing2Xnorm1Xingroup + framing2Xnorm2Xingroup + framing2Xnorm3Xingroup + framing2Xnorm4Xingroup + framing1Xextraversion + framing2Xextraversion + norm1Xextraversion + norm2Xextraversion + norm3Xextraversion + norm4Xextraversion + framing1Xnorm1Xextraversion + framing1Xnorm2Xextraversion + framing1Xnorm3Xextraversion + framing1Xnorm4Xextraversion + framing2Xnorm1Xextraversion + framing2Xnorm2Xextraversion + framing2Xnorm3Xextraversion + framing2Xnorm4Xextraversion + framing1Xconscientiousness + framing2Xconscientiousness + norm1Xconscientiousness + norm2Xconscientiousness + norm3Xconscientiousness + norm4Xconscientiousness + framing1Xnorm1Xconscientiousness + framing1Xnorm2Xconscientiousness + framing1Xnorm3Xconscientiousness + framing1Xnorm4Xconscientiousness + framing2Xnorm1Xconscientiousness + framing2Xnorm2Xconscientiousness + framing2Xnorm3Xconscientiousness + framing2Xnorm4Xconscientiousness + framing1Xagreeableness + framing2Xagreeableness + norm1Xagreeableness + norm2Xagreeableness + norm3Xagreeableness + norm4Xagreeableness + framing1Xnorm1Xagreeableness + framing1Xnorm2Xagreeableness + framing1Xnorm3Xagreeableness + framing1Xnorm4Xagreeableness + framing2Xnorm1Xagreeableness + framing2Xnorm2Xagreeableness + framing2Xnorm3Xagreeableness + framing2Xnorm4Xagreeableness + framing1Xopenness + framing2Xopenness + norm1Xopenness + norm2Xopenness + norm3Xopenness + norm4Xopenness + framing1Xnorm1Xopenness + framing1Xnorm2Xopenness + framing1Xnorm3Xopenness + framing1Xnorm4Xopenness + framing2Xnorm1Xopenness + framing2Xnorm2Xopenness + framing2Xnorm3Xopenness + framing2Xnorm4Xopenness + framing1Xneuroticism + framing2Xneuroticism + norm1Xneuroticism + norm2Xneuroticism + norm3Xneuroticism + norm4Xneuroticism + framing1Xnorm1Xneuroticism + framing1Xnorm2Xneuroticism + framing1Xnorm3Xneuroticism + framing1Xnorm4Xneuroticism + framing2Xnorm1Xneuroticism + framing2Xnorm2Xneuroticism + framing2Xnorm3Xneuroticism + framing2Xnorm4Xneuroticism + framing1Xhonesty + framing2Xhonesty + norm1Xhonesty + norm2Xhonesty + norm3Xhonesty + norm4Xhonesty + framing1Xnorm1Xhonesty + framing1Xnorm2Xhonesty + framing1Xnorm3Xhonesty + framing1Xnorm4Xhonesty + framing2Xnorm1Xhonesty + framing2Xnorm2Xhonesty + framing2Xnorm3Xhonesty + framing2Xnorm4Xhonesty",
               method = c("norm","norm","norm","norm","","norm","","norm","norm","","logreg","logreg","","","norm", "norm", "norm", "norm", "norm", "norm","","","","","","","FramingCode1*biospheric","FramingCode2*biospheric","NormCode1*biospheric","NormCode2*biospheric","NormCode3*biospheric","NormCode4*biospheric","FramingCode1*NormCode1*biospheric","FramingCode1*NormCode2*biospheric","FramingCode1*NormCode3*biospheric","FramingCode1*NormCode4*biospheric","FramingCode2*NormCode1*biospheric","FramingCode2*NormCode2*biospheric","FramingCode2*NormCode3*biospheric","FramingCode2*NormCode4*biospheric","FramingCode1*altruistic","FramingCode2*altruistic","NormCode1*altruistic","NormCode2*altruistic","NormCode3*altruistic","NormCode4*altruistic","FramingCode1*NormCode1*altruistic","FramingCode1*NormCode2*altruistic","FramingCode1*NormCode3*altruistic","FramingCode1*NormCode4*altruistic","FramingCode2*NormCode1*altruistic","FramingCode2*NormCode2*altruistic","FramingCode2*NormCode3*altruistic","FramingCode2*NormCode4*altruistic","FramingCode1*egoistic","FramingCode2*egoistic","NormCode1*egoistic","NormCode2*egoistic","NormCode3*egoistic","NormCode4*egoistic","FramingCode1*NormCode1*egoistic","FramingCode1*NormCode2*egoistic","FramingCode1*NormCode3*egoistic","FramingCode1*NormCode4*egoistic","FramingCode2*NormCode1*egoistic","FramingCode2*NormCode2*egoistic","FramingCode2*NormCode3*egoistic","FramingCode2*NormCode4*egoistic","FramingCode1*hedonic","FramingCode2*hedonic","NormCode1*hedonic","NormCode2*hedonic","NormCode3*hedonic","NormCode4*hedonic","FramingCode1*NormCode1*hedonic","FramingCode1*NormCode2*hedonic","FramingCode1*NormCode3*hedonic","FramingCode1*NormCode4*hedonic","FramingCode2*NormCode1*hedonic","FramingCode2*NormCode2*hedonic","FramingCode2*NormCode3*hedonic","FramingCode2*NormCode4*hedonic","","","","","","","","","","","","","","","FramingCode1*extraversion","FramingCode2*extraversion","NormCode1*extraversion","NormCode2*extraversion","NormCode3*extraversion","NormCode4*extraversion","FramingCode1*NormCode1*extraversion","FramingCode1*NormCode2*extraversion","FramingCode1*NormCode3*extraversion","FramingCode1*NormCode4*extraversion","FramingCode2*NormCode1*extraversion","FramingCode2*NormCode2*extraversion","FramingCode2*NormCode3*extraversion","FramingCode2*NormCode4*extraversion","FramingCode1*conscientiousness","FramingCode2*conscientiousness","NormCode1*conscientiousness","NormCode2*conscientiousness","NormCode3*conscientiousness","NormCode4*conscientiousness","FramingCode1*NormCode1*conscientiousness","FramingCode1*NormCode2*conscientiousness","FramingCode1*NormCode3*conscientiousness","FramingCode1*NormCode4*conscientiousness","FramingCode2*NormCode1*conscientiousness","FramingCode2*NormCode2*conscientiousness","FramingCode2*NormCode3*conscientiousness","FramingCode2*NormCode4*conscientiousness","FramingCode1*agreeableness","FramingCode2*agreeableness","NormCode1*agreeableness","NormCode2*agreeableness","NormCode3*agreeableness","NormCode4*agreeableness","FramingCode1*NormCode1*agreeableness","FramingCode1*NormCode2*agreeableness","FramingCode1*NormCode3*agreeableness","FramingCode1*NormCode4*agreeableness","FramingCode2*NormCode1*agreeableness","FramingCode2*NormCode2*agreeableness","FramingCode2*NormCode3*agreeableness","FramingCode2*NormCode4*agreeableness","FramingCode1*openness","FramingCode2*openness","NormCode1*openness","NormCode2*openness","NormCode3*openness","NormCode4*openness","FramingCode1*NormCode1*openness","FramingCode1*NormCode2*openness","FramingCode1*NormCode3*openness","FramingCode1*NormCode4*openness","FramingCode2*NormCode1*openness","FramingCode2*NormCode2*openness","FramingCode2*NormCode3*openness","FramingCode2*NormCode4*openness","FramingCode1*neuroticism","FramingCode2*neuroticism","NormCode1*neuroticism","NormCode2*neuroticism","NormCode3*neuroticism","NormCode4*neuroticism","FramingCode1*NormCode1*neuroticism","FramingCode1*NormCode2*neuroticism","FramingCode1*NormCode3*neuroticism","FramingCode1*NormCode4*neuroticism","FramingCode2*NormCode1*neuroticism","FramingCode2*NormCode2*neuroticism","FramingCode2*NormCode3*neuroticism","FramingCode2*NormCode4*neuroticism","FramingCode1*honesty","FramingCode2*honesty","NormCode1*honesty","NormCode2*honesty","NormCode3*honesty","NormCode4*honesty","FramingCode1*NormCode1*honesty","FramingCode1*NormCode2*honesty","FramingCode1*NormCode3*honesty","FramingCode1*NormCode4*honesty","FramingCode2*NormCode1*honesty","FramingCode2*NormCode2*honesty","FramingCode2*NormCode3*honesty","FramingCode2*NormCode4*honesty"))
```


Storing imputed data sets
```{r}
impobject <- imputationList(imps$impDatasets)
```

### Centering continuous predictors
```{r}
# Biospheric values
impobject$imputations[[1]]$biospheric_center <- impobject$imputations[[1]]$biospheric - mean(impobject$imputations[[1]]$biospheric)

impobject$imputations[[2]]$biospheric_center <- impobject$imputations[[2]]$biospheric - mean(impobject$imputations[[2]]$biospheric)

impobject$imputations[[3]]$biospheric_center <- impobject$imputations[[3]]$biospheric - mean(impobject$imputations[[3]]$biospheric)

impobject$imputations[[4]]$biospheric_center <- impobject$imputations[[4]]$biospheric - mean(impobject$imputations[[4]]$biospheric)

impobject$imputations[[5]]$biospheric_center <- impobject$imputations[[5]]$biospheric - mean(impobject$imputations[[5]]$biospheric)


# Altruistic values
impobject$imputations[[1]]$altruistic_center <- impobject$imputations[[1]]$altruistic - mean(impobject$imputations[[1]]$altruistic)

impobject$imputations[[2]]$altruistic_center <- impobject$imputations[[2]]$altruistic - mean(impobject$imputations[[2]]$altruistic)

impobject$imputations[[3]]$altruistic_center <- impobject$imputations[[3]]$altruistic - mean(impobject$imputations[[3]]$altruistic)

impobject$imputations[[4]]$altruistic_center <- impobject$imputations[[4]]$altruistic - mean(impobject$imputations[[4]]$altruistic)

impobject$imputations[[5]]$altruistic_center <- impobject$imputations[[5]]$altruistic - mean(impobject$imputations[[5]]$altruistic)


# Egoistic values
impobject$imputations[[1]]$egoistic_center <- impobject$imputations[[1]]$egoistic - mean(impobject$imputations[[1]]$egoistic)

impobject$imputations[[2]]$egoistic_center <- impobject$imputations[[2]]$egoistic - mean(impobject$imputations[[2]]$egoistic)

impobject$imputations[[3]]$egoistic_center <- impobject$imputations[[3]]$egoistic - mean(impobject$imputations[[3]]$egoistic)

impobject$imputations[[4]]$egoistic_center <- impobject$imputations[[4]]$egoistic - mean(impobject$imputations[[4]]$egoistic)

impobject$imputations[[5]]$egoistic_center <- impobject$imputations[[5]]$egoistic - mean(impobject$imputations[[5]]$egoistic)


# Hedonic values
impobject$imputations[[1]]$hedonic_center <- impobject$imputations[[1]]$hedonic - mean(impobject$imputations[[1]]$hedonic)

impobject$imputations[[2]]$hedonic_center <- impobject$imputations[[2]]$hedonic - mean(impobject$imputations[[2]]$hedonic)

impobject$imputations[[3]]$hedonic_center <- impobject$imputations[[3]]$hedonic - mean(impobject$imputations[[3]]$hedonic)

impobject$imputations[[4]]$hedonic_center <- impobject$imputations[[4]]$hedonic - mean(impobject$imputations[[4]]$hedonic)

impobject$imputations[[5]]$hedonic_center <- impobject$imputations[[5]]$hedonic - mean(impobject$imputations[[5]]$hedonic)



# Ingroup identification
impobject$imputations[[1]]$ingroup_center <- impobject$imputations[[1]]$ingroup_identification - mean(impobject$imputations[[1]]$ingroup_identification)

impobject$imputations[[2]]$ingroup_center <- impobject$imputations[[2]]$ingroup_identification - mean(impobject$imputations[[2]]$ingroup_identification)

impobject$imputations[[3]]$ingroup_center <- impobject$imputations[[3]]$ingroup_identification - mean(impobject$imputations[[3]]$ingroup_identification)

impobject$imputations[[4]]$ingroup_center <- impobject$imputations[[4]]$ingroup_identification - mean(impobject$imputations[[4]]$ingroup_identification)

impobject$imputations[[5]]$ingroup_center <- impobject$imputations[[5]]$ingroup_identification - mean(impobject$imputations[[5]]$ingroup_identification)


# Age
impobject$imputations[[1]]$Age_center <- impobject$imputations[[1]]$Age - mean(impobject$imputations[[1]]$Age)

impobject$imputations[[2]]$Age_center <- impobject$imputations[[2]]$Age - mean(impobject$imputations[[2]]$Age)

impobject$imputations[[3]]$Age_center <- impobject$imputations[[3]]$Age - mean(impobject$imputations[[3]]$Age)

impobject$imputations[[4]]$Age_center <- impobject$imputations[[4]]$Age - mean(impobject$imputations[[4]]$Age)

impobject$imputations[[5]]$Age_center <- impobject$imputations[[5]]$Age - mean(impobject$imputations[[5]]$Age)



# Clothing interest
impobject$imputations[[1]]$clothing_center <- impobject$imputations[[1]]$clothing_interest - mean(impobject$imputations[[1]]$clothing_interest)

impobject$imputations[[2]]$clothing_center <- impobject$imputations[[2]]$clothing_interest - mean(impobject$imputations[[2]]$clothing_interest)

impobject$imputations[[3]]$clothing_center <- impobject$imputations[[3]]$clothing_interest - mean(impobject$imputations[[3]]$clothing_interest)

impobject$imputations[[4]]$clothing_center <- impobject$imputations[[4]]$clothing_interest - mean(impobject$imputations[[4]]$clothing_interest)

impobject$imputations[[5]]$clothing_center <- impobject$imputations[[5]]$clothing_interest - mean(impobject$imputations[[5]]$clothing_interest)



# Self deceptive SDR
impobject$imputations[[1]]$self_dec_center <- impobject$imputations[[1]]$self_deceptive_sdr - mean(impobject$imputations[[1]]$self_deceptive_sdr)

impobject$imputations[[2]]$self_dec_center <- impobject$imputations[[2]]$self_deceptive_sdr - mean(impobject$imputations[[2]]$self_deceptive_sdr)

impobject$imputations[[3]]$self_dec_center <- impobject$imputations[[3]]$self_deceptive_sdr - mean(impobject$imputations[[3]]$self_deceptive_sdr)

impobject$imputations[[4]]$self_dec_center <- impobject$imputations[[4]]$self_deceptive_sdr - mean(impobject$imputations[[4]]$self_deceptive_sdr)

impobject$imputations[[5]]$self_dec_center <- impobject$imputations[[5]]$self_deceptive_sdr - mean(impobject$imputations[[5]]$self_deceptive_sdr)


# Impression management SDR
impobject$imputations[[1]]$impress_manag_center <- impobject$imputations[[1]]$impress_manag_sdr - mean(impobject$imputations[[1]]$impress_manag_sdr)

impobject$imputations[[2]]$impress_manag_center <- impobject$imputations[[2]]$impress_manag_sdr - mean(impobject$imputations[[2]]$impress_manag_sdr)

impobject$imputations[[3]]$impress_manag_center <- impobject$imputations[[3]]$impress_manag_sdr - mean(impobject$imputations[[3]]$impress_manag_sdr)

impobject$imputations[[4]]$impress_manag_center <- impobject$imputations[[4]]$impress_manag_sdr - mean(impobject$imputations[[4]]$impress_manag_sdr)

impobject$imputations[[5]]$impress_manag_center <- impobject$imputations[[5]]$impress_manag_sdr - mean(impobject$imputations[[5]]$impress_manag_sdr)

# Extraversion
impobject$imputations[[1]]$extraversion_center <- impobject$imputations[[1]]$extraversion - mean(impobject$imputations[[1]]$extraversion)

impobject$imputations[[2]]$extraversion_center <- impobject$imputations[[2]]$extraversion - mean(impobject$imputations[[2]]$extraversion)

impobject$imputations[[3]]$extraversion_center <- impobject$imputations[[3]]$extraversion - mean(impobject$imputations[[3]]$extraversion)

impobject$imputations[[4]]$extraversion_center <- impobject$imputations[[4]]$extraversion - mean(impobject$imputations[[4]]$extraversion)

impobject$imputations[[5]]$extraversion_center <- impobject$imputations[[5]]$extraversion - mean(impobject$imputations[[5]]$extraversion)

# Conscientiousness
impobject$imputations[[1]]$conscientiousness_center <- impobject$imputations[[1]]$conscientiousness - mean(impobject$imputations[[1]]$conscientiousness)

impobject$imputations[[2]]$conscientiousness_center <- impobject$imputations[[2]]$conscientiousness - mean(impobject$imputations[[2]]$conscientiousness)

impobject$imputations[[3]]$conscientiousness_center <- impobject$imputations[[3]]$conscientiousness - mean(impobject$imputations[[3]]$conscientiousness)

impobject$imputations[[4]]$conscientiousness_center <- impobject$imputations[[4]]$conscientiousness - mean(impobject$imputations[[4]]$conscientiousness)

impobject$imputations[[5]]$conscientiousness_center <- impobject$imputations[[5]]$conscientiousness - mean(impobject$imputations[[5]]$conscientiousness)

# Agreeableness
impobject$imputations[[1]]$agreeableness_center <- impobject$imputations[[1]]$agreeableness - mean(impobject$imputations[[1]]$agreeableness)

impobject$imputations[[2]]$agreeableness_center <- impobject$imputations[[2]]$agreeableness - mean(impobject$imputations[[2]]$agreeableness)

impobject$imputations[[3]]$agreeableness_center <- impobject$imputations[[3]]$agreeableness - mean(impobject$imputations[[3]]$agreeableness)

impobject$imputations[[4]]$agreeableness_center <- impobject$imputations[[4]]$agreeableness - mean(impobject$imputations[[4]]$agreeableness)

impobject$imputations[[5]]$agreeableness_center <- impobject$imputations[[5]]$agreeableness - mean(impobject$imputations[[5]]$agreeableness)

# Openness
impobject$imputations[[1]]$openness_center <- impobject$imputations[[1]]$openness - mean(impobject$imputations[[1]]$openness)

impobject$imputations[[2]]$openness_center <- impobject$imputations[[2]]$openness - mean(impobject$imputations[[2]]$openness)

impobject$imputations[[3]]$openness_center <- impobject$imputations[[3]]$openness - mean(impobject$imputations[[3]]$openness)

impobject$imputations[[4]]$openness_center <- impobject$imputations[[4]]$openness - mean(impobject$imputations[[4]]$openness)

impobject$imputations[[5]]$openness_center <- impobject$imputations[[5]]$openness - mean(impobject$imputations[[5]]$openness)

# Neuroticism
impobject$imputations[[1]]$neuroticism_center <- impobject$imputations[[1]]$neuroticism - mean(impobject$imputations[[1]]$neuroticism)

impobject$imputations[[2]]$neuroticism_center <- impobject$imputations[[2]]$neuroticism - mean(impobject$imputations[[2]]$neuroticism)

impobject$imputations[[3]]$neuroticism_center <- impobject$imputations[[3]]$neuroticism - mean(impobject$imputations[[3]]$neuroticism)

impobject$imputations[[4]]$neuroticism_center <- impobject$imputations[[4]]$neuroticism - mean(impobject$imputations[[4]]$neuroticism)

impobject$imputations[[5]]$neuroticism_center <- impobject$imputations[[5]]$neuroticism - mean(impobject$imputations[[5]]$neuroticism)

# Honesty
impobject$imputations[[1]]$honesty_center <- impobject$imputations[[1]]$honesty - mean(impobject$imputations[[1]]$honesty)

impobject$imputations[[2]]$honesty_center <- impobject$imputations[[2]]$honesty - mean(impobject$imputations[[2]]$honesty)

impobject$imputations[[3]]$honesty_center <- impobject$imputations[[3]]$honesty - mean(impobject$imputations[[3]]$honesty)

impobject$imputations[[4]]$honesty_center <- impobject$imputations[[4]]$honesty - mean(impobject$imputations[[4]]$honesty)

impobject$imputations[[5]]$honesty_center <- impobject$imputations[[5]]$honesty - mean(impobject$imputations[[5]]$honesty)
```




Convert `scmfcs` object to a `mids` object (to make the object compatible with `mice`, and thus, `emmeans`):
```{r}
mids_obj <- datlist2mids(impobject)
```

Complete data set:
```{r complete imputed data set, include = FALSE}
complete_data <- complete(mids_obj, "long")
```





## Running Model
```{r}
mod_mice <- with(mids_obj, lm(consumer_intentions ~ framing_condition*norm_condition*biospheric_center + framing_condition*norm_condition*altruistic_center + framing_condition*norm_condition*egoistic_center + framing_condition*norm_condition*hedonic_center + framing_condition*norm_condition*ingroup_center + framing_condition*norm_condition*extraversion_center + framing_condition*norm_condition*conscientiousness_center + framing_condition*norm_condition*agreeableness_center + framing_condition*norm_condition*openness_center + framing_condition*norm_condition*neuroticism_center + framing_condition*norm_condition*honesty_center + self_dec_center + impress_manag_center + clothing_center + Gender + Age_center))
```

```{r}
pool_obj <- pool(mod_mice)

pool_obj
```


## Pooled Regression Results

Using `mice` package:
```{r}
# summary(pool(mod_mice))

pool_summ <- summary(pool(mod_mice)) %>%
  knitr::kable(digits = 5)

pool_summ
```


## Pooled Anova Results
```{r echo = FALSE}
anova_pool <- mi.anova(mi.res = mids_obj, formula = "consumer_intentions ~ framing_condition*norm_condition*biospheric_center + framing_condition*norm_condition*altruistic_center + framing_condition*norm_condition*egoistic_center + framing_condition*norm_condition*hedonic_center + framing_condition*norm_condition*ingroup_center + framing_condition*norm_condition*extraversion_center + framing_condition*norm_condition*conscientiousness_center + framing_condition*norm_condition*agreeableness_center + framing_condition*norm_condition*openness_center + framing_condition*norm_condition*neuroticism_center + framing_condition*norm_condition*honesty_center + self_dec_center + impress_manag_center + clothing_center + Gender + Age_center", type = 3) 
```


```{r}
anova_pool %>%
  knitr::kable(digits = 3)
```



# Simple Effects

* add data points onto graphs (see if dotarg = list(color = "black") works)
* add test of significance of simple slopes
* remove CI bars where it's obscuring the findings (or make thinner?)

## Personality Interactions

### Extraversion

First, relationship between extraversion & consumer intentions for each norm condition:
```{r}
emtrends(mod_mice, ~norm_condition, var = "extraversion_center", adjust = "none")

# On a single graph
at_list <- list(extraversion_center = seq(-2.2, 2, by = 1))

emmip(mod_mice, norm_condition ~ extraversion_center, at = at_list, CIs = TRUE, xlab = "Extraversion (centered)", ylab = "Consumer Intentions", dotarg = list(color = "black"))
```


Is the slope of the relationship between extraversion & consumer intentions stronger in any one of the norm conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~norm_condition, var = "extraversion_center", adjust = "none")
```


Second, relationship between extraversion & consumer intentions for each framing condition:
```{r}
emtrends(mod_mice, ~framing_condition, var = "extraversion_center", adjust = "none")

# On a single graph
at_list <- list(extraversion_center = seq(-2.2, 2, by = 1))

emmip(mod_mice, framing_condition ~ extraversion_center, at = at_list, CIs = TRUE, xlab = "Extraversion (centered)", ylab = "Consumer Intentions")
```


Is the slope of the relationship between extraversion & consumer intentions stronger in any one of the framing conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~framing_condition, var = "extraversion_center", adjust = "none")
```


Third, interaction between extraversion, framing, & norm condition:
```{r}
emtrends(mod_mice, ~norm_condition | framing_condition, var = "extraversion_center", adjust = "none")

# Separate graph for each framing condition
at_list <- list(extraversion_center = seq(-2.2, 2, by = 1))

emmip(mod_mice, norm_condition ~ extraversion_center | framing_condition, at = at_list, CIs = TRUE, xlab = "Extraversion (centered)", ylab = "Consumer Intentions")
```





### Agreeableness

First, relationship between agreeableness & consumer intentions for each norm condition:
```{r}
emtrends(mod_mice, ~norm_condition, var = "agreeableness_center", adjust = "none")

# On a single graph
at_list <- list(agreeableness_center = seq(-2, 1.4, by = 1))

emmip(mod_mice, norm_condition ~ agreeableness_center, at = at_list, CIs = TRUE, xlab = "agreeableness (centered)", ylab = "Consumer Intentions")
```


Is the slope of the relationship between agreeableness & consumer intentions stronger in any one of the norm conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~norm_condition, var = "agreeableness_center", adjust = "none")
```


Second, relationship between agreeableness & consumer intentions for each framing condition:
```{r}
emtrends(mod_mice, ~framing_condition, var = "agreeableness_center", adjust = "none")

# On a single graph
at_list <- list(agreeableness_center = seq(-2, 1.4, by = 1))

emmip(mod_mice, framing_condition ~ agreeableness_center, at = at_list, CIs = TRUE, xlab = "agreeableness (centered)", ylab = "Consumer Intentions")
```


Is the slope of the relationship between agreeableness & consumer intentions stronger in any one of the framing conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~framing_condition, var = "agreeableness_center", adjust = "none")
```


Third, interaction between agreeableness, framing, & norm condition:
```{r}
emtrends(mod_mice, ~norm_condition | framing_condition, var = "agreeableness_center", adjust = "none")

# Separate graph for each framing condition
at_list <- list(agreeableness_center = seq(-2, 1.4, by = 1))

emmip(mod_mice, norm_condition ~ agreeableness_center | framing_condition, at = at_list, CIs = TRUE, xlab = "agreeableness (centered)", ylab = "Consumer Intentions")
```





### Openness

First, relationship between openness & consumer intentions for each norm condition:
```{r}
emtrends(mod_mice, ~norm_condition, var = "openness_center", adjust = "none")

# On a single graph
at_list <- list(openness_center = seq(-2.5, 1.4, by = 1))

emmip(mod_mice, norm_condition ~ openness_center, at = at_list, CIs = TRUE, xlab = "openness (centered)", ylab = "Consumer Intentions")
```


Is the slope of the relationship between openness & consumer intentions stronger in any one of the norm conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~norm_condition, var = "openness_center", adjust = "none")
```


Second, relationship between openness & consumer intentions for each framing condition:
```{r}
emtrends(mod_mice, ~framing_condition, var = "openness_center", adjust = "none")

# On a single graph
at_list <- list(openness_center = seq(-2.5, 1.4, by = 1))

emmip(mod_mice, framing_condition ~ openness_center, at = at_list, CIs = TRUE, xlab = "openness (centered)", ylab = "Consumer Intentions")
```


Is the slope of the relationship between openness & consumer intentions stronger in any one of the framing conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~framing_condition, var = "openness_center", adjust = "none")
```


Third, interaction between openness, framing, & norm condition:
```{r}
emtrends(mod_mice, ~norm_condition | framing_condition, var = "openness_center", adjust = "none")

# Separate graph for each framing condition
at_list <- list(openness_center = seq(-2.5, 1.4, by = 1))

emmip(mod_mice, norm_condition ~ openness_center | framing_condition, at = at_list, CIs = TRUE, xlab = "openness (centered)", ylab = "Consumer Intentions")
```





### Conscientiousness

First, relationship between conscientiousness & consumer intentions for each norm condition:
```{r}
emtrends(mod_mice, ~norm_condition, var = "conscientiousness_center", adjust = "none")

# On a single graph
at_list <- list(conscientiousness_center = seq(-2.1, 1.7, by = 1))

emmip(mod_mice, norm_condition ~ conscientiousness_center, at = at_list, CIs = TRUE, xlab = "conscientiousness (centered)", ylab = "Consumer Intentions")
```


Is the slope of the relationship between conscientiousness & consumer intentions stronger in any one of the norm conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~norm_condition, var = "conscientiousness_center", adjust = "none")
```


Second, relationship between conscientiousness & consumer intentions for each framing condition:
```{r}
emtrends(mod_mice, ~framing_condition, var = "conscientiousness_center", adjust = "none")

# On a single graph
at_list <- list(conscientiousness_center = seq(-2.1, 1.7, by = 1))

emmip(mod_mice, framing_condition ~ conscientiousness_center, at = at_list, CIs = TRUE, xlab = "conscientiousness (centered)", ylab = "Consumer Intentions")
```


Is the slope of the relationship between conscientiousness & consumer intentions stronger in any one of the framing conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~framing_condition, var = "conscientiousness_center", adjust = "none")
```


Third, interaction between conscientiousness, framing, & norm condition:
```{r}
emtrends(mod_mice, ~norm_condition | framing_condition, var = "conscientiousness_center", adjust = "none")

# Separate graph for each framing condition
at_list <- list(conscientiousness_center = seq(-2.1, 1.7, by = 1))

emmip(mod_mice, norm_condition ~ conscientiousness_center | framing_condition, at = at_list, CIs = TRUE, xlab = "conscientiousness (centered)", ylab = "Consumer Intentions")
```




### Neuroticism

First, relationship between neuroticism & consumer intentions for each norm condition:
```{r}
emtrends(mod_mice, ~norm_condition, var = "neuroticism_center", adjust = "none")

# On a single graph
at_list <- list(neuroticism_center = seq(-2.2, 2.1, by = 1))

emmip(mod_mice, norm_condition ~ neuroticism_center, at = at_list, CIs = TRUE, xlab = "neuroticism (centered)", ylab = "Consumer Intentions")
```


Is the slope of the relationship between neuroticism & consumer intentions stronger in any one of the norm conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~norm_condition, var = "neuroticism_center", adjust = "none")
```


Second, relationship between neuroticism & consumer intentions for each framing condition:
```{r}
emtrends(mod_mice, ~framing_condition, var = "neuroticism_center", adjust = "none")

# On a single graph
at_list <- list(neuroticism_center = seq(-2.2, 2.1, by = 1))

emmip(mod_mice, framing_condition ~ neuroticism_center, at = at_list, CIs = TRUE, xlab = "neuroticism (centered)", ylab = "Consumer Intentions")
```


Is the slope of the relationship between neuroticism & consumer intentions stronger in any one of the framing conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~framing_condition, var = "neuroticism_center", adjust = "none")
```


Third, interaction between neuroticism, framing, & norm condition:
```{r}
emtrends(mod_mice, ~norm_condition | framing_condition, var = "neuroticism_center", adjust = "none")

# Separate graph for each framing condition
at_list <- list(neuroticism_center = seq(-2.2, 2.1, by = 1))

emmip(mod_mice, norm_condition ~ neuroticism_center | framing_condition, at = at_list, CIs = TRUE, xlab = "neuroticism (centered)", ylab = "Consumer Intentions")
```



### Honesty

First, relationship between honesty & consumer intentions for each norm condition:
```{r}
emtrends(mod_mice, ~norm_condition, var = "honesty_center", adjust = "none")

# On a single graph
at_list <- list(honesty_center = seq(-2.5, 1.6, by = 1))

emmip(mod_mice, norm_condition ~ honesty_center, at = at_list, CIs = TRUE, xlab = "honesty (centered)", ylab = "Consumer Intentions")
```


Is the slope of the relationship between honesty & consumer intentions stronger in any one of the norm conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~norm_condition, var = "honesty_center", adjust = "none")
```


Second, relationship between honesty & consumer intentions for each framing condition:
```{r}
emtrends(mod_mice, ~framing_condition, var = "honesty_center", adjust = "none")

# On a single graph
at_list <- list(honesty_center = seq(-2.5, 1.6, by = 1))

emmip(mod_mice, framing_condition ~ honesty_center, at = at_list, CIs = TRUE, xlab = "honesty (centered)", ylab = "Consumer Intentions")
```


Is the slope of the relationship between honesty & consumer intentions stronger in any one of the framing conditions compared to the others?

```{r}
emtrends(mod_mice, pairwise~framing_condition, var = "honesty_center", adjust = "none")
```


Third, interaction between honesty, framing, & norm condition:
```{r}
emtrends(mod_mice, ~norm_condition | framing_condition, var = "honesty_center", adjust = "none")

# Separate graph for each framing condition
at_list <- list(honesty_center = seq(-2.5, 1.6, by = 1))

emmip(mod_mice, norm_condition ~ honesty_center | framing_condition, at = at_list, CIs = TRUE, xlab = "honesty (centered)", ylab = "Consumer Intentions")
```