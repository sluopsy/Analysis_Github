---
title: "Visualizations (Prior to Analysis)"
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
date: "2023-03-29"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

```{r clear environment, echo = FALSE}
rm(list = ls())
```


```{r libraries, message = FALSE, warning = FALSE}
library(Rmisc)
library(Hmisc)
library(rio)
library(tidyverse)
library(psych)
library(gtools) # rbinding data frames
library(corrplot)
library(jtools) # for pretty printing tables
library(sjPlot) # pretty printing tables
library(sjmisc) # pretty printing
library(mice) # handling missing values
library(naniar) # visualizaing missingness & MCAR test
library(miceadds) # for mi.anova
library(emmeans) # simple effects analyses
library(broom)     # for extracting residuals and outlier indices
library(olsrr)     # for creating outlier plots

options(max.print = 100000)
```

# Data Import & Cleaning

## Import data
```{r import data}
raw_psych_hum_subj <- import("data/raw/raw_psych_hum_subj.csv")
raw_mktg_hum_subj <- import("data/raw/raw_mktg_hum_subj.csv")
raw_gen_uo_pop <- import("data/raw/raw_gen_uo_pop.csv")
pre_fall22 <- import("data/prescreen/dittersdorf_matches_f22.csv")
pre_winter23 <- import("data/prescreen/dittersdorf_matches_w23.csv")
pre_spring23 <- import("data/prescreen/dittersdorf_matches_s23.csv")
participant_list <- import("data/prescreen/dittersdorf_participants.csv")
```


Inspect data
```{r inspect raw data, results = 'hide'}
# Main Data
str(raw_psych_hum_subj, list.len = ncol(raw_psych_hum_subj))
str(raw_mktg_hum_subj, list.len = ncol(raw_mktg_hum_subj))
str(raw_gen_uo_pop, list.len = ncol(raw_gen_uo_pop))
```


## Change variables types 
```{r update var types, warning = FALSE}
raw_psych_hum_subj <- raw_psych_hum_subj %>%
  mutate(Age = as.integer(Age),
         Gender = as.factor(Gender),
         framing_condition_DO = as.factor(framing_condition_DO),
         norm_condition_DO = as.factor(norm_condition_DO),
         consumer_behaviors = as.factor(consumer_behaviors),
         skepticism = as.factor(skepticism),
         id = as.factor(id))

raw_mktg_hum_subj <- raw_mktg_hum_subj %>%
  mutate(Age = as.integer(Age),
         Gender = as.factor(Gender),
         Gender_5_TEXT = as.character(Gender_5_TEXT),
         Class_Lvl_7_TEXT = as.character(Class_Lvl_7_TEXT),
         Pol_Ornt_8_TEXT = as.character(Pol_Ornt_8_TEXT),
         Ethnicity_8_TEXT = as.character(Ethnicity_8_TEXT),
         skept_open = as.character(skept_open),
         skepticism = as.factor(skepticism),
         id = as.factor(id),
         framing_condition_DO = as.factor(framing_condition_DO),
         norm_condition_DO = as.factor(norm_condition_DO),
         consumer_behaviors = as.factor(consumer_behaviors))

raw_gen_uo_pop <- raw_gen_uo_pop %>%
  mutate(Gender = as.factor(Gender),
         Gender_5_TEXT = as.character(Gender_5_TEXT),
         Class_Lvl_7_TEXT = as.character(Class_Lvl_7_TEXT),
         Pol_Ornt_8_TEXT = as.character(Pol_Ornt_8_TEXT),
         skept_open = as.character(skept_open),
         skepticism = as.factor(skepticism),
         id = as.factor(id),
         framing_condition_DO = as.factor(framing_condition_DO),
         norm_condition_DO = as.factor(norm_condition_DO),
         consumer_behaviors = as.factor(consumer_behaviors))
```


Inspect prescreen data
```{r inspect prescreen, results = 'hide'}
# Prescreen Data
str(pre_fall22, list.len = ncol(pre_fall22))
str(pre_winter23, list.len = ncol(pre_winter23))
str(pre_spring23, list.len = ncol(pre_spring23))
str(participant_list, list.len = ncol(participant_list))
```

Variables from prescreen:

* Values:
  + respecting, unity, protecting, preventing, equality, peace, justice, helpful, power, wealth, authority, influential, ambition, pleasures, enjoying, gratification

* Socially Desirable Responding:
  + honest, like, disturbing, regret, lose-out, rational, confident, lover, lies, cover-up, advantage, get-even, behind-back, private-talk, take-things, gossip

## Combine prescreen data

Specify unique variables to combine prescreen data sets
```{r prep prescreen dfs}
# Create unique full_name variable
pre_fall22$full_name <- paste(pre_fall22$first_name, pre_fall22$last_name, sep="_")

pre_winter23$full_name <- paste(pre_winter23$first_name, pre_winter23$last_name, sep="_")

pre_spring23$full_name <- paste(pre_spring23$first_name, pre_spring23$last_name, sep="_")

participant_list$full_name <- paste(participant_list$first_name, participant_list$last_name, sep="_")

# Create column indicating which data set rows came from

pre_fall22 <- pre_fall22 %>%
  mutate(term = "fall22")

pre_winter23 <- pre_winter23 %>%
  mutate(term = "winter23")

pre_spring23 <- pre_spring23 %>%
  mutate(term = "spring23")
```

Combine prescreen data
```{r combine prescreen dfs}
combine1 <- smartbind(pre_fall22, pre_winter23)
combined_prescreen <- smartbind(combine1, pre_spring23)

nrow(pre_fall22) + nrow(pre_winter23) + nrow(pre_spring23) # n = 1167

combined_prescreen_unique <- combined_prescreen[!duplicated(combined_prescreen$full_name), ] # keeps first row (fall22)
```

Subset key variables
```{r subset key vars}
combined_prescreen_key <- combined_prescreen_unique %>%
  select(full_name, term, respecting:gratification, honest:gossip)

participant_list_key <- participant_list %>%
  select(full_name, survey_id)
```

Merge with participant list
```{r merge participant list}
merged_prescreen <- merge(combined_prescreen_key, participant_list_key, by = "full_name")
```

Convert variable types in prescreen data
```{r inspect merged prescreen, results = 'hide'}
str(merged_prescreen, list.len = ncol(merged_prescreen))
```

```{r clean merged prescreen, warning = FALSE}
merged_prescreen <- merged_prescreen %>%
  rename("lose_out" = "lose-out", 
         "cover_up" = "cover-up",
         "get_even" = "get-even",
         "behind_back" = "behind-back",
         "private_talk" = "private-talk",
         "take_things" = "take-things",
         "id" = "survey_id")

merged_prescreen <- merged_prescreen %>%
  mutate(respecting = as.integer(respecting),
         unity = as.integer(unity),
         protecting = as.integer(protecting),
         preventing = as.integer(preventing),
         equality = as.integer(equality),
         peace = as.integer(peace),
         justice = as.integer(justice),
         helpful = as.integer(helpful),
         power = as.integer(power),
         wealth = as.integer(wealth),
         authority = as.integer(authority),
         influential = as.integer(influential),
         ambition = as.integer(ambition),
         pleasures = as.integer(pleasures),
         enjoying = as.integer(enjoying),
         gratification = as.integer(gratification),
         honest = as.integer(honest),
         like = as.integer(like),
         disturbing = as.integer(disturbing),
         regret = as.integer(regret),
         lose_out = as.integer(lose_out),
         rational = as.integer(rational),
         confident = as.integer(confident),
         lover = as.integer(lover),
         lies = as.integer(lies),
         cover_up = as.integer(cover_up),
         advantage = as.integer(advantage),
         get_even = as.integer(get_even),
         behind_back = as.integer(behind_back),
         private_talk = as.integer(private_talk),
         take_things = as.integer(take_things),
         gossip = as.integer(gossip),
         id = as.factor(id))
```


Rename values & socially desirable items in prescreen data to match names in main data:
```{r rename prescreen vars}
merged_prescreen <- merged_prescreen %>%
  rename("values_1" = "respecting",
         "values_2" = "unity",
         "values_3" = "protecting",
         "values_4" = "preventing",
         "values_5" = "equality",
         "values_6" = "peace",
         "values_7" = "justice",
         "values_8" = "helpful",
         "values_9" = "power",
         "values_10" = "wealth",
         "values_11" = "authority",
         "values_12" = "influential",
         "values_13" = "ambition",
         "values_14" = "pleasures",
         "values_15" = "enjoying",
         "values_16" = "gratification",
         "socially_desirable_1" = "honest",
         "socially_desirable_2" = "like",
         "socially_desirable_3" = "disturbing",
         "socially_desirable_4" = "regret",
         "socially_desirable_5" = "lose_out",
         "socially_desirable_6" = "rational",
         "socially_desirable_7" = "confident",
         "socially_desirable_8" = "lover",
         "socially_desirable_9" = "lies",
         "socially_desirable_10" = "cover_up",
         "socially_desirable_11" = "advantage",
         "socially_desirable_12" = "get_even",
         "socially_desirable_13" = "behind_back",
         "socially_desirable_14" = "private_talk",
         "socially_desirable_15" = "take_things",
         "socially_desirable_16" = "gossip")
```


## Combine all data

- First, combine Psych Hum Subj data with Prescreen data based on `id`
- Second, add Mktg Hum Subj data
- Third, add gen UO Pop data
```{r combine all data}
combine1 <- merge(raw_psych_hum_subj, merged_prescreen, by = "id")
combine2 <- smartbind(combine1, raw_mktg_hum_subj)
combine3 <- smartbind(combine2, raw_gen_uo_pop)
```

## Remove duplicate cases

Identify duplicate cases
```{r id duplicate cases, results = 'hide'}
# first, add unique row #s
combine3 <- combine3 %>%
  mutate(row = 1:nrow(combine3))

combine3[duplicated(combine3$id),] # Only rows 1 through 858 have unique id #s

# write.csv(combine3, "combined_data.csv")
```

Row IDs to remove:

* 13 (participant's second time completing study)
* 134 (participant didn't complete study first time)
* 145 (participant didn't complete study first time)
* 308 (participant's second time completing study)
* 672 (participant's second time completing study)
* 743 (participant didn't complete study first time)
* 790 (participant didn't complete study first time)
* 800 (participant didn't complete study first time)

Remove duplicate rows after resolving:
```{r remove duplicate cases}
combine3 <- combine3 %>%
  filter(!row %in% c(13, 134, 145, 308, 672, 743, 790, 800))
```

Check variables types again
```{r inspect var types again, results = 'hide'}
str(combine3, list.len = ncol(combine3))
```

## Remove all NA cases

Identify completely missing rows:
```{r id all NA rows, results = 'hide'}
key_vars <- combine3 %>%
  select(row, big_2_1:big_2_65, consumer_intentions_1:consumer_intentions_9, consumer_behaviors, clothing_interest_1:clothing_interest_20, ingroup_ident_1:ingroup_ident_14, values_1:values_16, socially_desirable_1:socially_desirable_16)

ncol(key_vars) # number of columns - the row # column = 141

all_NA_rows <- key_vars[rowSums(is.na(key_vars)) == 141,] # identify rows with 142 NAs (all missing values), row numbers are preserved

all_NA_rows
```

Removing rows of fully missing data:
```{r remove all NA rows}
data <- combine3 %>%
  filter(!row %in% c(859, 860, 900, 926, 927, 941, 1139, 1141, 1142, 1143, 1144, 1146, 1149, 1150, 1152)) %>% # remove rows containing all NAs
  select(-StartDate, -EndDate, -Status, -Progress, -"Duration (in seconds)", -Finished, -RecordedDate, -ResponseId, -DistributionChannel, -UserLanguage, -big_2_DO, -consumer_intentions_DO, -consumer_behaviors_DO, -clothing_interest_DO, -ingroup_ident_DO, -full_name, -code, -socially_desirable_DO, -values_DO, -email_giftcard, -term) # removing variables not in analysis
```


Rename variables:
```{r rename vars}
data <- data %>%
  rename("framing_condition" = "framing_condition_DO", 
         "norm_condition" = "norm_condition_DO")

levels(data$framing_condition)
levels(data$norm_condition)

data$framing_condition <- droplevels(data$framing_condition)
data$norm_condition <- droplevels(data$norm_condition)

levels(data$framing_condition)
levels(data$norm_condition)

levels(data$skepticism)
```



## Demographics

Age
```{r age outliers}
# Age
data %>%
  select(Age) %>%
  hist()

describe(data$Age) # 1999 a data entry error

data %>%
  filter(Age == 1999) # Row 1053, Year 1999 = 24 years old

data$Age[data$Age == 1999] <- 24

data %>%
  filter(row == 1053) %>%
  select(Age) # Age has been replaced with 24
```

Income

- 1 = $0-9,999
- 2 = $10,000 - 19,999
- 3 = $20,000 - 29,999
- 4 = $30,000 - 39,999
- 5 = $40,000 - 49.999
- 6 = $50,000 - 59,999
- 7 = $60,000 - 69,999
- 8 = $70,000 - 79,999
- 9 = $80,000 - 89,999
- 10 = $90,000 - 99,999
- 11 = $100,000 or more
```{r income outliers}
data %>%
  select(Income) %>%
  boxplot()

describe(data$Income)

table(data$Income)

data %>%
  filter(Income == 11 | Income == 10 | Income == 9 | Income == 8 | Income == 7) %>%
  select(Income, Age, Employment, Class_Lvl)
```

Employment

- 1 = Employed, working 1-39 hrs/wk
- 2 = Employed, working 40+ hrs/wk
- 3 = Not employed, looking for work
- 4 = Not employed, NOT looking for work
- 5 = Retired
- 6 = Not able to work

Class Level

- 1 = Freshman
- 2 = Sophomore
- 3 = Junior
- 4 = Senior
- 5 = Graduate student
- 6 = Not applicable
- 7 = Other


Gender

- 1 = woman
- 2 = man
- 3 = non-binary
- 4 = I prefer not to identify
- 5 = other (please specify)
```{r label gender levels}
levels(data$Gender) <- c("Woman", "Man", "Non-binary", "I prefer not to identify", "Other")

table(data$Gender) 

data %>%
  filter(Gender == 5) %>%
  select(Gender_5_TEXT)
```


# Aggregate Variables 

## Personality

### Reverse-code

```{r reverse personality items}
data_R <- data %>%
  mutate(across(c(big_2_11,
                  big_2_16,
                  big_2_26,
                  big_2_31,
                  big_2_36,
                  big_2_51,
                  big_2_12,
                  big_2_17,
                  big_2_22,
                  big_2_37,
                  big_2_42,
                  big_2_47,
                  big_2_3,
                  big_2_8,
                  big_2_23,
                  big_2_28,
                  big_2_48,
                  big_2_58,
                  big_2_4,
                  big_2_9,
                  big_2_24,
                  big_2_29,
                  big_2_44,
                  big_2_49,
                  big_2_5,
                  big_2_25,
                  big_2_30,
                  big_2_45,
                  big_2_50,
                  big_2_55,
                  big_2_63), ~6 - .)) # replace '6' with the max possible value plus 1 for any particular scale
```

### Average items

```{r aggregate personality}
data_R$extraversion <- data_R %>%
  select(big_2_1, big_2_6, big_2_11, big_2_16, big_2_21, big_2_26, big_2_31, big_2_36, big_2_41, big_2_46, big_2_51, big_2_56) %>%
  rowMeans(na.rm = TRUE) 


data_R$conscientiousness <- data_R %>%
  select(big_2_3, big_2_8, big_2_13, big_2_18, big_2_23, big_2_28, big_2_33, big_2_38, big_2_43, big_2_48, big_2_53, big_2_58) %>%
  rowMeans(na.rm = TRUE)


data_R$agreeableness <- data_R %>%
  select(big_2_2, big_2_7, big_2_12, big_2_17, big_2_22, big_2_27, big_2_32, big_2_37, big_2_42, big_2_47, big_2_52, big_2_57) %>%
  rowMeans(na.rm = TRUE)


data_R$neuroticism <- data_R %>%
  select(big_2_4, big_2_9, big_2_14, big_2_19, big_2_24, big_2_29, big_2_34, big_2_39, big_2_44, big_2_49, big_2_54, big_2_59) %>%
  rowMeans(na.rm = TRUE)


data_R$openness <- data_R %>%
  select(big_2_5, big_2_10, big_2_15, big_2_20, big_2_25, big_2_30, big_2_35, big_2_40, big_2_45, big_2_50, big_2_55, big_2_60) %>%
  rowMeans(na.rm = TRUE)


data_R$honesty <- data_R %>%
  select(big_2_61, big_2_62, big_2_63, big_2_64, big_2_65) %>%
  rowMeans(na.rm = TRUE)
```

### Scale reliability

```{r alpha personality traits, echo = FALSE}
# Extraversion items
alpha_ext <- data_R %>%
  select(big_2_1, big_2_6, big_2_11, big_2_16, big_2_21, big_2_26, big_2_31, big_2_36, big_2_41, big_2_46, big_2_51, big_2_56) %>%
  alpha()

# Conscientiousness items
alpha_cons <- data_R %>%
  select(big_2_3, big_2_8, big_2_13, big_2_18, big_2_23, big_2_28, big_2_33, big_2_38, big_2_43, big_2_48, big_2_53, big_2_58) %>%
  alpha()

# Agreeableness items
alpha_agree <- data_R %>%
  select(big_2_2, big_2_7, big_2_12, big_2_17, big_2_22, big_2_27, big_2_32, big_2_37, big_2_42, big_2_47, big_2_52, big_2_57) %>%
  alpha()

# Neuroticism items
alpha_neur <- data_R %>%
  select(big_2_4, big_2_9, big_2_14, big_2_19, big_2_24, big_2_29, big_2_34, big_2_39, big_2_44, big_2_49, big_2_54, big_2_59) %>%
  alpha()

# Openness items
alpha_open <- data_R %>%
  select(big_2_5, big_2_10, big_2_15, big_2_20, big_2_25, big_2_30, big_2_35, big_2_40, big_2_45, big_2_50, big_2_55, big_2_60) %>%
  alpha()

# Honesty items
alpha_hone <- data_R %>%
  select(big_2_61, big_2_62, big_2_63, big_2_64, big_2_65) %>%
  alpha()

alpha_ext
alpha_cons
alpha_agree
alpha_neur
alpha_open
alpha_hone
```


## Clothing Interest

### Reverse-code

```{r reverse clothing items}
data_R <- data_R %>%
  mutate(across(c(clothing_interest_3,
                  clothing_interest_5,
                  clothing_interest_7,
                  clothing_interest_9,
                  clothing_interest_12,
                  clothing_interest_14,
                  clothing_interest_15,
                  clothing_interest_16,
                  clothing_interest_18,
                  clothing_interest_20), ~6 - .)) # replace '#' with the max possible value plus 1 for any particular scale
```


### Average items
```{r aggregate clothing interest}
data_R$clothing_interest <- data_R %>%
  select(clothing_interest_1:clothing_interest_20) %>%
  rowMeans(na.rm = TRUE)
```

### Scale reliability
```{r alpha clothing interest, echo = FALSE}
alpha_cloth <- data_R %>%
  select(clothing_interest_1:clothing_interest_20) %>%
  alpha()

alpha_cloth
```


## In-group Identification

### Reverse-code

No items need to be reverse-coded.

### Average items
```{r aggegate ingroup ident}
data_R$ingroup_identification <- data_R %>%
  select(ingroup_ident_1:ingroup_ident_14) %>%
  rowMeans(na.rm = TRUE)
```

### Scale reliability
```{r alpha ingroup ident, echo = FALSE}
alpha_ingroup <- data_R %>%
  select(ingroup_ident_1:ingroup_ident_14) %>%
  alpha()

alpha_ingroup
```


## Values

### Reverse-code

No items need to be reverse-coded.

### Recoding scale options

Recoding values:

* -3 = 1
* -2 = 2
* -1 = 3
* 0 = 4
* +1 = 5
* +2 = 6
* +3 = 7

```{r recode values}
table(data_R$values_1)

data_R$values_1_rec <- recode(data_R$values_1, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)

table(data_R$values_1_rec)

data_R$values_2_rec <- recode(data_R$values_2, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_3_rec <- recode(data_R$values_3, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_4_rec <- recode(data_R$values_4, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_5_rec <- recode(data_R$values_5, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_6_rec <- recode(data_R$values_6, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_7_rec <- recode(data_R$values_7, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_8_rec <- recode(data_R$values_8, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_9_rec <- recode(data_R$values_9, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_10_rec <- recode(data_R$values_10, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_11_rec <- recode(data_R$values_11, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_12_rec <- recode(data_R$values_12, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_13_rec <- recode(data_R$values_13, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_14_rec <- recode(data_R$values_14, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_15_rec <- recode(data_R$values_15, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_16_rec <- recode(data_R$values_16, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)

table(data_R$values_16)
table(data_R$values_16_rec)
```


### Average items
```{r aggregate values}
data_R$biospheric <- data_R %>%
  select(values_1_rec:values_4_rec) %>%
  rowMeans(na.rm = TRUE)

data_R$altruistic <- data_R %>%
  select(values_5_rec:values_8_rec) %>%
  rowMeans(na.rm = TRUE)

data_R$egoistic <- data_R %>%
  select(values_9_rec:values_13_rec) %>%
  rowMeans(na.rm = TRUE)

data_R$hedonic <- data_R %>%
  select(values_14_rec:values_16_rec) %>%
  rowMeans(na.rm = TRUE)
```

### Scale reliability
```{r alpha values, echo = FALSE}
alpha_biospheric <- data_R %>%
  select(values_1_rec:values_4_rec) %>%
  alpha()

alpha_altruistic <- data_R %>%
  select(values_5_rec:values_8_rec) %>%
  alpha()

alpha_egoistic <- data_R %>%
  select(values_9_rec:values_13_rec) %>%
  alpha()

alpha_hedonic <- data_R %>%
  select(values_14_rec:values_16_rec) %>%
  alpha()

alpha_biospheric
alpha_altruistic
alpha_egoistic
alpha_hedonic
```



## Socially Desirable Responding

### Reverse-code
```{r reverse code socially desirable items}
data_R <- data_R %>%
  mutate(across(c(socially_desirable_1,
                  socially_desirable_3,
                  socially_desirable_5,
                  socially_desirable_8,
                  socially_desirable_9,
                  socially_desirable_11,
                  socially_desirable_12,
                  socially_desirable_13), ~8 - .)) # replace '#' with the max possible value plus 1 for any particular scale
```

### Average items
```{r aggregate socially desirable}
data_R$socially_desirable <- data_R %>%
  select(socially_desirable_1:socially_desirable_16) %>%
  rowMeans(na.rm = TRUE)
```

### Scale reliability
```{r alpha socially desirable, echo = FALSE}
alpha_SDR <- data_R %>%
  select(socially_desirable_1:socially_desirable_16) %>%
  alpha()

alpha_SDR
```


## Consumer Intentions

### Reverse-code

Higher scores mean better consumer intentions (intentions to *reduce* future consumption):
```{r reverse code consumer intentions}
data_R <- data_R %>%
  mutate(across(c(consumer_intentions_2,
                  consumer_intentions_4,
                  consumer_intentions_7,
                  consumer_intentions_9), ~8 - .)) # replace '#' with the max possible value plus 1 for any particular scale
```

### Average items

```{r aggregate consumer intentions}
data_R$consumer_intentions <- data_R %>%
  select(consumer_intentions_1:consumer_intentions_9) %>%
  rowMeans(na.rm = TRUE)
```

### Scale reliability

```{r alpha consumer intentions, echo = FALSE}
alpha_cons_int <- data_R %>%
  select(consumer_intentions_1:consumer_intentions_9) %>%
  alpha()

alpha_cons_int
```

### Reorder levels

Reorder the levels of norm condition:
```{r reorder norm condition levels}
data_R %>%
  group_by(norm_condition) %>%
  summarize(M = mean(consumer_intentions, na.rm = TRUE))

data_R$norm_condition <- ordered(data_R$norm_condition, levels = c("control_norm", "descriptive_norm", "convention_norm", "social_norm", "moral_norm"))
```



## Consumer Behaviors

* consumer_behaviors
  + 1 = I would like to enter into the raffle for a $50 gift card to spend on **new clothing items.**
  + 2 = I would like to enter into the raffle for a $50 gift card to spend on **secondhand clothing items.**


Label levels of consumer behaviors:
```{r label levels of consumer behaviors, echo = FALSE, warning = FALSE}
levels(data_R$consumer_behaviors) <- c("New Clothing", "Secondhand Clothing")
```


## Skepticism

  + 1 = Yes
  + 2 = No

Q: Is skepticism higher in one of the framing and/or norm conditions compared to the others?

Label levels of skepticism:
```{r label skepticism, echo = FALSE, warning = FALSE}
levels(data_R$skepticism) <- c("Yes", "No")
```




# Visualizations

## All Variables

### Correlation Matrix

```{r corr matrix, echo = FALSE}
cor_matrix <- data_R %>%
  select(consumer_intentions, ingroup_identification, clothing_interest, socially_desirable, Age, biospheric, altruistic, egoistic, hedonic) %>%
  cor(use = "pairwise.complete.obs")

knitr::kable(cor_matrix, digits = 2)

corrplot(cor_matrix, method = 'circle', type = 'lower', diag = FALSE)

```


## Consumer Intentions

### Main Effect of Framing Condition
```{r line graph main effect framing on consumer intentions}
# x-axis = framing condition
summary_data <- summarySE(data_R, measurevar = "consumer_intentions", groupvars = c("framing_condition"))

summary_data

## Line Graph
ggplot(summary_data, aes(x = framing_condition, y = consumer_intentions, color = framing_condition)) +
  geom_errorbar(aes(ymin = consumer_intentions-ci, ymax = consumer_intentions+ci), width = .1) + # 95%CI bars
  geom_line() +
  scale_color_manual(values = c("red", "chartreuse4", "blue")) +
  geom_point() +
  labs(title    = "Main Effect of Framing Condition on Consumer Intentions",
       x        = " ",
       y        = "Consumer Intentions",
       subtitle  = "Group Means and 95% Confidence Interval Bars") +
  scale_x_discrete(labels=c("Control Framing", "Pro-Environmental Framing", "Self-Enhancing Framing")) +
  theme(legend.position = "none")
```

### Main Effect of Norm Condition
```{r line graph main effect of norm on consumer intentions}
# x-axis = norm condition
summary_data2 <- summarySE(data_R, measurevar = "consumer_intentions", groupvars = c("norm_condition"))

summary_data2

## Line Graph

ggplot(summary_data2, aes(x = norm_condition, y = consumer_intentions, color = norm_condition)) +
  geom_errorbar(aes(ymin = consumer_intentions-ci, ymax = consumer_intentions+ci), width = .1) + # 95%CI bars
  geom_line() +
  scale_color_manual(values = c("red", "chartreuse4", "blue", "darkviolet", "orange")) +
  geom_point() +
  labs(title    = "Main Effect of Norm Condition on Consumer Intentions",
       x        = " ",
       y        = "Consumer Intentions",
       subtitle  = "Group Means and 95% Confidence Interval Bars") +
  scale_x_discrete(labels=c("Control Norm", "Descriptive Norm", "Convention", "Social Norm", "Moral Norm")) +
  theme(legend.position = "none")
```



```{r bar graph main effects, echo = FALSE, include = FALSE}
## x-axis = framing condition
summary_data$framing_condition <- as.factor(summary_data$framing_condition)

ggplot(summary_data, aes(x = framing_condition, y = consumer_intentions)) +
  geom_bar(stat = "identity") +
  geom_errorbar(aes(ymin = consumer_intentions-ci, ymax = consumer_intentions+ci), width = .1) # 95%CI bars

## x-axis = norm condition
summary_data2$norm_condition <- as.factor(summary_data2$norm_condition)

ggplot(summary_data2, aes(x = norm_condition, y = consumer_intentions)) +
  geom_bar(stat = "identity") +
  geom_errorbar(aes(ymin = consumer_intentions-ci, ymax = consumer_intentions+ci), width = .1) # 95%CI bars
```


### Interaction Effect

Norm Condition on x-Axis:
```{r line graph interaction effect on consumer intentions}
summary_data3 <- summarySE(data_R, measurevar = "consumer_intentions", groupvars = c("framing_condition", "norm_condition"))

summary_data3

## Line Graph

# Norm condition on x-axis
ggplot(summary_data3, aes(x = norm_condition, y = consumer_intentions, group = framing_condition, colour = framing_condition)) +
  geom_errorbar(aes(ymin = consumer_intentions-ci, ymax = consumer_intentions+ci), width = .1) + # 95%CI bars
  geom_line() +
  geom_point() +
  scale_color_manual(values = c("red", "chartreuse4", "blue"), name = "Framing Condition", labels = c("Control", "Pro-Environmental", "Self-Enhancing")) +
  labs(title    = "Interaction between Framing and Norm Condition on Consumer Intentions",
       x        = " ",
       y        = "Consumer Intentions",
       subtitle  = "Group Means and 95% Confidence Interval Bars") +
  scale_x_discrete(labels=c("Control Norm", "Descriptive Norm", "Convention", "Social Norm", "Moral Norm"))
```


Framing Condition on x-axis:
```{r int effect framing on x-axis}
# Framing condition on x-axis
ggplot(summary_data3, aes(x = framing_condition, y = consumer_intentions, group = norm_condition, colour = norm_condition)) +
  geom_errorbar(aes(ymin = consumer_intentions-ci, ymax = consumer_intentions+ci), width = .1) + # 95%CI bars
  geom_line() +
  geom_point() +
  scale_color_manual(values = c("red", "green", "blue", "darkviolet", "orange"), name = "Norm Condition", labels = c("Control", "Descriptive Norm", "Convention", "Social Norm", "Moral Norm")) +
  labs(title    = "Interaction between Framing and Norm Condition on Consumer Intentions",
       x        = " ",
       y        = "Consumer Intentions",
       subtitle  = "Group Means and 95% Confidence Interval Bars") +
  scale_x_discrete(labels=c("Control Framing", "Pro-Environmental Framing", "Self-Enhancing Framing"))
```



```{r bar graph interaction effect, echo = FALSE, include = FALSE}
## Bar Graph
summary_data3$norm_condition <- as.factor(summary_data3$norm_condition)

# Norm condition on x-axis
ggplot(summary_data3, aes(x = norm_condition, y = consumer_intentions, fill = framing_condition)) +
  geom_bar(position = position_dodge(), stat = "identity") +
  geom_errorbar(aes(ymin = consumer_intentions-ci, ymax = consumer_intentions+ci), width = .2, position = position_dodge(.9)) # 95%CI bars


# Framing condition on x-axis
ggplot(summary_data3, aes(x = framing_condition, y = consumer_intentions, fill = norm_condition)) +
  geom_bar(position = position_dodge(), stat = "identity") +
  geom_errorbar(aes(ymin = consumer_intentions-ci, ymax = consumer_intentions+ci), width = .2, position = position_dodge(.9)) # 95%CI bars
```



### Values

Values and Consumer Inetntions
```{r echo = FALSE}
# biospheric values
data_R %>%
  ggplot(aes(x = biospheric, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(title    = "Relationship Between Biospheric Values and Consumer Intentions",
       x        = "Biospheric Values",
       y        = "Consumer Intentions")


# egoistic values
data_R %>%
  ggplot(aes(x = egoistic, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(title    = "Relationship Between Egoistic Values and Consumer Intentions",
       x        = "Egoistic Values",
       y        = "Consumer Intentions")


# altruistic values
data_R %>%
  ggplot(aes(x = altruistic, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(title    = "Relationship Between Altruistic Values and Consumer Intentions",
       x        = "Altruistic Values",
       y        = "Consumer Intentions")


# hedonic values
data_R %>%
  ggplot(aes(x = hedonic, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(title    = "Relationship Between Hedonic Values and Consumer Intentions",
       x        = "Hedonic Values",
       y        = "Consumer Intentions")
```



Values by Norms on Consumer Intentions
```{r values by norms, echo = FALSE}
# biospheric values
data_R %>%
  ggplot(aes(x = biospheric, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  theme_minimal() +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  labs(title    = "Relationship Between Biospheric Values by Norms on Consumer Intentions",
       x        = "Biospheric Values",
       y        = "Consumer Intentions")


# egoistic values
data_R %>%
  ggplot(aes(x = egoistic, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  theme_minimal() +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  labs(title    = "Relationship Between Egoistic Values by Norms on Consumer Intentions",
       x        = "Egoistic Values",
       y        = "Consumer Intentions")



# altruistic values
data_R %>%
  ggplot(aes(x = altruistic, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  theme_minimal() +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  labs(title    = "Relationship Between Altruistic Values by Norms on Consumer Intentions",
       x        = "Altruistic Values",
       y        = "Consumer Intentions")


# hedonic values
data_R %>%
  ggplot(aes(x = hedonic, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  theme_minimal() +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  labs(title    = "Relationship Between Hedonic Values by Norms on Consumer Intentions",
       x        = "Hedonic Values",
       y        = "Consumer Intentions")
```




Values by Framing on Consumer Intentions
```{r values by framing, echo = FALSE}
# biospheric values
data_R %>%
  ggplot(aes(x = biospheric, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, aes(color = framing_condition)) +
  theme_minimal() +
  scale_color_manual(values = c("red", "blue", "green")) +
  labs(title    = "Relationship Between Biospheric Values by Framing Condition on Consumer Intentions",
       x        = "Biospheric Values",
       y        = "Consumer Intentions")


# egoistic values
data_R %>%
  ggplot(aes(x = egoistic, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, aes(color = framing_condition)) +
  theme_minimal() +
  scale_color_manual(values = c("red", "blue", "green")) +
  labs(title    = "Relationship Between Egoistic Values by Framing Condition on Consumer Intentions",
       x        = "Egoistic Values",
       y        = "Consumer Intentions")



# altruistic values
data_R %>%
  ggplot(aes(x = altruistic, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, aes(color = framing_condition)) +
  theme_minimal() +
  scale_color_manual(values = c("red", "blue", "green")) +
  labs(title    = "Relationship Between Altruistic Values by Framing Condition on Consumer Intentions",
       x        = "Altruistic Values",
       y        = "Consumer Intentions")


# hedonic values
data_R %>%
  ggplot(aes(x = hedonic, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, aes(color = framing_condition)) +
  theme_minimal() +
  scale_color_manual(values = c("red", "blue", "green")) +
  labs(title    = "Relationship Between Hedonic Values by Framing Condition on Consumer Intentions",
       x        = "Hedonic Values",
       y        = "Consumer Intentions")
```





Values by Norms & Framing on Consumer Intentions
```{r values by framing, norm, echo = FALSE}
# biospheric values
data_R %>% 
ggplot(aes(x = biospheric, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  facet_wrap(~framing_condition) +
  labs(title    = "Three-way Interaction between Biospheric Values, Norm Condition, & Framing Condition",
       x        = "Biospheric Values",
       y        = "Consumer Intentions")


# egoistic values
data_R %>% 
ggplot(aes(x = egoistic, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  facet_wrap(~framing_condition) +
  labs(title    = "Three-way Interaction between Egoistic Values, Norm Condition, & Framing Condition",
       x        = "Egoistic Values",
       y        = "Consumer Intentions")


# altruistic values
data_R %>% 
ggplot(aes(x = altruistic, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  facet_wrap(~framing_condition) +
  labs(title    = "Three-way Interaction between Altruistic Values, Norm Condition, & Framing Condition",
       x        = "Altruistic Values",
       y        = "Consumer Intentions")


# hedonic values
data_R %>% 
ggplot(aes(x = hedonic, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  facet_wrap(~framing_condition) +
  labs(title    = "Three-way Interaction between Hedonic Values, Norm Condition, & Framing Condition",
       x        = "Hedonic Values",
       y        = "Consumer Intentions")

```



### Ingroup Identification

Ingroup Identification and Consumer Intentions
```{r echo = FALSE}
data_R %>%
  ggplot(aes(x = ingroup_identification, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(title    = "Relationship Between Ingroup Identification and Consumer Intentions",
       x        = "Ingroup Identification",
       y        = "Consumer Intentions")
```

Ingroup Identification by Norms
```{r}
data_R %>%
  ggplot(aes(x = ingroup_identification, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  theme_minimal() +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  labs(title    = "Relationship Between Ingroup Identification by Norms on Consumer Intentions",
       x        = "Ingroup Identification",
       y        = "Consumer Intentions")
```

Ingroup Identification by Framing
```{r}
data_R %>%
  ggplot(aes(x = ingroup_identification, y = consumer_intentions)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, aes(color = framing_condition)) +
  theme_minimal() +
  scale_color_manual(values = c("red", "blue", "green")) +
  labs(title    = "Relationship Between Ingroup Identification by Framing on Consumer Intentions",
       x        = "Ingroup Identification",
       y        = "Consumer Intentions")
```

Ingroup Identification by Norms and Framing
```{r}
data_R %>% 
ggplot(aes(x = ingroup_identification, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  facet_wrap(~framing_condition) +
  labs(title    = "Three-way Interaction between Ingroup Identification, Norm Condition, & Framing Condition",
       x        = "Ingroup Identification",
       y        = "Consumer Intentions")
```



### Personality


Plots of Framing Condition by Personality Traits (DV: Consumer Intentions)
```{r plots of framing condition X personality traits, echo = FALSE}
# extraversion
data_R %>% 
ggplot(aes(x = extraversion, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = framing_condition)) +
  scale_color_manual(values = c("red", "blue", "green")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Extraversion and Framing Condition on Consumer Intentions",
       x        = "Extraversion",
       y        = "Consumer Intentions")

# conscientiousness
data_R %>% 
ggplot(aes(x = conscientiousness, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = framing_condition)) +
  scale_color_manual(values = c("red", "blue", "green")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Conscientiousness and Framing Condition on Consumer Intentions",
       x        = "Conscientiousness",
       y        = "Consumer Intentions")

# agreeableness
data_R %>% 
ggplot(aes(x = agreeableness, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = framing_condition)) +
  scale_color_manual(values = c("red", "blue", "green")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Agreeableness and Framing Condition on Consumer Intentions",
       x        = "Agreeableness",
       y        = "Consumer Intentions")

# openness
data_R %>% 
ggplot(aes(x = openness, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = framing_condition)) +
  scale_color_manual(values = c("red", "blue", "green")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Openness and Framing Condition on Consumer Intentions",
       x        = "Openness",
       y        = "Consumer Intentions")

# neuroticism
data_R %>% 
ggplot(aes(x = neuroticism, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = framing_condition)) +
  scale_color_manual(values = c("red", "blue", "green")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Neuroticism and Framing Condition on Consumer Intentions",
       x        = "Neuroticism",
       y        = "Consumer Intentions")

# honesty
data_R %>% 
ggplot(aes(x = honesty, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = framing_condition)) +
  scale_color_manual(values = c("red", "blue", "green")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Honesty and Framing Condition on Consumer Intentions",
       x        = "Honesty",
       y        = "Consumer Intentions")
```



Plots of Norm Condition by Personality Traits (DV: Consumer Intentions)
```{r plots of norm condition X personality traits, echo = FALSE}
# extraversion
data_R %>% 
ggplot(aes(x = extraversion, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Extraversion and Norm Condition on Consumer Intentions",
       x        = "Extraversion",
       y        = "Consumer Intentions")

# conscientiousness
data_R %>% 
ggplot(aes(x = conscientiousness, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Conscientiousness and Norm Condition on Consumer Intentions",
       x        = "Conscientiousness",
       y        = "Consumer Intentions")

# agreeableness
data_R %>% 
ggplot(aes(x = agreeableness, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Agreeableness and Norm Condition on Consumer Intentions",
       x        = "Agreeableness",
       y        = "Consumer Intentions")

# openness
data_R %>% 
ggplot(aes(x = openness, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Openness and Norm Condition on Consumer Intentions",
       x        = "Openness",
       y        = "Consumer Intentions")

# neuroticism
data_R %>% 
ggplot(aes(x = neuroticism, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Neuroticism and Norm Condition on Consumer Intentions",
       x        = "Neuroticism",
       y        = "Consumer Intentions")

# honesty
data_R %>% 
ggplot(aes(x = honesty, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Honesty and Norm Condition on Consumer Intentions",
       x        = "Honesty",
       y        = "Consumer Intentions")
```


Three-way interaction between *framing condition*, *norm condition* and *openness*:
```{r three-way int framing, norm, openness, echo = FALSE}
## Control framing
data_R %>% 
  filter(framing_condition == "control_framing") %>%
ggplot(aes(x = openness, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Openness and Norm Condition on Consumer Intentions",
       subtitle = "In the Control Framing Condition",
       x        = "Openness",
       y        = "Consumer Intentions")

## Pro-environmental framing
data_R %>% 
  filter(framing_condition == "pro_env_framing") %>%
ggplot(aes(x = openness, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Openness and Norm Condition on Consumer Intentions",
       subtitle = "In the Pro-Environmental Framing Condition",
       x        = "Openness",
       y        = "Consumer Intentions")

## Self-enhancing framing
data_R %>% 
  filter(framing_condition == "self_enh_framing") %>%
ggplot(aes(x = openness, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  labs(title    = "Two-Way Interaction Between Openness and Norm Condition on Consumer Intentions",
       subtitle = "In the Self-Enhancing Framing Condition",
       x        = "Openness",
       y        = "Consumer Intentions")



## Single graph
data_R %>% 
ggplot(aes(x = openness, y = consumer_intentions)) +
  geom_point()+
  geom_smooth(method = "lm", se = FALSE, aes(color = norm_condition)) +
  scale_color_manual(values = c("red", "blue", "green", "yellow", "orange")) +
  theme_minimal() +
  facet_wrap(~framing_condition) +
  labs(title    = "Three-Way Interaction between Openness, Norm Condition, & Framing Condition",
       x        = "Openness",
       y        = "Consumer Intentions")
```




## Consumer Behaviors

### Main Effect of Framing Condition

First, calculate percentage of participants choosing new clothing or secondhand clothing in each framing condition:
```{r calc percentages framing condition by consumer behaviors}
# Calculate consumer behavior percentages for each framing condition
behavior_percentages_framing <- data_R %>%
  group_by(framing_condition) %>%
  count(consumer_behaviors) %>%
  mutate(Percent = n / sum(n)*100)

behavior_percentages_framing$Percent <- round(behavior_percentages_framing$Percent, 2)
```

Then, plot percentages across framing conditions:
```{r plot framing conditions by consumer behaviors, echo = FALSE}
# Plot using bar chart
filter(behavior_percentages_framing, !is.na(consumer_behaviors)) %>%
ggplot(aes(x = framing_condition, y = Percent, fill = consumer_behaviors)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Framing Condition", y = "Percentage", fill = "Consumer Behaviors") +
  scale_fill_manual(values = c("darkorchid", "darkturquoise")) +
  labs(title    = "Main Effect of Framing Condition on Consumer Behaviors",
       x        = " ",
       y        = "Consumer Behaviors (%)") +
  scale_x_discrete(labels=c("Control Framing", "Pro-Environmental Framing", "Self-Enhancing Framing"))
```

### Main Effect of Norm Condition

First, calculate percentage of participants choosing new clothing or secondhand clothing in each norm condition:
```{r calc percentages norm by consumer behaviors}
# Calculate consumer behavior percentages for each norm condition
behavior_percentages_norm <- data_R %>%
  group_by(norm_condition) %>%
  count(consumer_behaviors) %>%
  mutate(Percent = n / sum(n)*100)

behavior_percentages_norm$Percent <- round(behavior_percentages_norm$Percent, 2)
```

Then, plot the percentages across norm conditions:
```{r plot norm by consuemr behaviors, echo = FALSE}
# Plot using bar chart
filter(behavior_percentages_norm, !is.na(consumer_behaviors)) %>%
ggplot(aes(x = norm_condition, y = Percent, fill = consumer_behaviors)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Norm Condition", y = "Percentage", fill = "Consumer Behaviors") +
  scale_fill_manual(values = c("darkorchid", "darkturquoise")) +
  labs(title    = "Main Effect of Norm Condition on Consumer Behaviors",
       x        = " ",
       y        = "Consumer Behaviors (%)") +
  scale_x_discrete(labels=c("Control Norm", "Descriptive Norm", "Convention", "Social Norm", "Moral Norm"))
```



### Interaction Effect

First, calculate percentages choosing new or secondhand clothing across each combination of framing X norm condition:
```{r calc percentages for interaction effect on consumer behaviors}
# Calculate consumer behavior percentages for each combination of framing X norm condition
behavior_percentages_int <- data_R %>%
  group_by(framing_condition, norm_condition) %>%
  count(consumer_behaviors) %>%
  mutate(Percent = n / sum(n)*100)

behavior_percentages_int$Percent <- round(behavior_percentages_int$Percent, 2)
```

Then, plot the percentages across framingXnorm conditions:
```{r plot consumer behavior percentages across framingXnorm conditions, echo = FALSE}
# x-axis: norm condition, facet_wrap: framing condition
filter(behavior_percentages_int, !is.na(consumer_behaviors)) %>%
ggplot(aes(x = norm_condition, y = Percent, fill = consumer_behaviors)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Norm Condition", y = "Percentage", fill = "Consumer Behaviors") +
  scale_fill_manual(values = c("darkorchid", "darkturquoise")) +
  labs(title    = "Interaction between Norm & Framing Condition on Consumer Behaviors",
       x        = " ",
       y        = "Consumer Behaviors (%)") +
  scale_x_discrete(labels=c("Control", "Descriptive Norm", "Convention", "Social Norm", "Moral Norm")) + 
  facet_wrap(~framing_condition)



# x-axis: framing condition, facet_wrap: norm condition
filter(behavior_percentages_int, !is.na(consumer_behaviors)) %>%
ggplot(aes(x = framing_condition, y = Percent, fill = consumer_behaviors)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Framing Condition", y = "Percentage", fill = "Consumer Behaviors") +
  scale_fill_manual(values = c("darkorchid", "darkturquoise")) +
  labs(title    = "Interaction between Norm & Framing Condition on Consumer Behaviors",
       x        = " ",
       y        = "Consumer Behaviors (%)") +
  scale_x_discrete(labels=c("Control Framing", "Pro-Environmental Framing", "Self-Enhancing Framing")) + 
  facet_wrap(~norm_condition)

```

