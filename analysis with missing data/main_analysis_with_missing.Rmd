---
title: "Analysis with Missing Data"
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
date: "2023-03-29"
editor_options: 
  chunk_output_type: console
---

To do:

  * logistic regression 
    - marginal means
    - simple effects analyses
    - descriptive statistics
  * apa style output (tables)
  * post-hoc power analyses
     - modelPower
  * add effect sizes to simple effects analyses

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

```{r clear environment, echo = FALSE}
rm(list = ls())
```


```{r libraries, message = FALSE, warning = FALSE, echo = FALSE}
library(Rmisc)
library(Hmisc)
library(rio)
library(tidyverse)
library(psych)
library(gtools) # rbinding data frames
library(corrplot)
library(jtools) # for pretty printing tables
library(sjPlot) # pretty printing tables
library(sjmisc) # pretty printing
library(mice) # handling missing values
library(naniar) # visualizaing missingness & MCAR test
library(miceadds) # for mi.anova
library(emmeans) # simple effects analyses
library(broom)     # for extracting residuals and outlier indices
library(olsrr)     # for creating outlier plots
library(effectsize)
#install.packages("remotes")
#remotes::install_github("connorjmccabe/modglm")
library(modglm) # unpacking interactions from glm models
library(aod) # for wald tests
library(epiDisplay)


options(scipen = 10000)
options(max.print = 100000)
```

# Data Import & Cleaning

## Import data
```{r import data}
raw_psych_hum_subj <- import("data/raw/raw_psych_hum_subj.csv")
raw_mktg_hum_subj <- import("data/raw/raw_mktg_hum_subj.csv")
raw_gen_uo_pop <- import("data/raw/raw_gen_uo_pop.csv")
pre_fall22 <- import("data/prescreen/dittersdorf_matches_f22.csv")
pre_winter23 <- import("data/prescreen/dittersdorf_matches_w23.csv")
pre_spring23 <- import("data/prescreen/dittersdorf_matches_s23.csv")
participant_list <- import("data/prescreen/dittersdorf_participants.csv")
```


```{r inspect raw data, results = 'hide', include = FALSE}
# Main Data
str(raw_psych_hum_subj, list.len = ncol(raw_psych_hum_subj))
str(raw_mktg_hum_subj, list.len = ncol(raw_mktg_hum_subj))
str(raw_gen_uo_pop, list.len = ncol(raw_gen_uo_pop))
```

## Fix age before converting variable types
```{r}
table(raw_psych_hum_subj$Age) # 18 years old = 18
table(raw_mktg_hum_subj$Age) # 1999 = 24
table(raw_gen_uo_pop$Age)

raw_psych_hum_subj$Age[raw_psych_hum_subj$Age == "18 years old"] <- 18
raw_mktg_hum_subj$Age[raw_mktg_hum_subj$Age == 1999] <- 24

table(raw_psych_hum_subj$Age) # 18 years old = 18
table(raw_mktg_hum_subj$Age) # 1999 = 24
```



## Change variables types 
```{r update var types, warning = FALSE}
raw_psych_hum_subj <- raw_psych_hum_subj %>%
  mutate(Age = as.integer(Age),
         Gender = as.factor(Gender),
         framing_condition_DO = as.factor(framing_condition_DO),
         norm_condition_DO = as.factor(norm_condition_DO),
         consumer_behaviors = as.factor(consumer_behaviors),
         skepticism = as.factor(skepticism),
         id = as.factor(id),
         source = strrep("psych_hsp", times = 1))

raw_mktg_hum_subj <- raw_mktg_hum_subj %>%
  mutate(Age = as.integer(Age),
         Gender = as.factor(Gender),
         Gender_5_TEXT = as.character(Gender_5_TEXT),
         Class_Lvl_7_TEXT = as.character(Class_Lvl_7_TEXT),
         Pol_Ornt_8_TEXT = as.character(Pol_Ornt_8_TEXT),
         Ethnicity_8_TEXT = as.character(Ethnicity_8_TEXT),
         skept_open = as.character(skept_open),
         skepticism = as.factor(skepticism),
         id = as.factor(id),
         framing_condition_DO = as.factor(framing_condition_DO),
         norm_condition_DO = as.factor(norm_condition_DO),
         consumer_behaviors = as.factor(consumer_behaviors),
         source = strrep("mktg_hsp", times = 1))

raw_gen_uo_pop <- raw_gen_uo_pop %>%
  mutate(Gender = as.factor(Gender),
         Gender_5_TEXT = as.character(Gender_5_TEXT),
         Class_Lvl_7_TEXT = as.character(Class_Lvl_7_TEXT),
         Pol_Ornt_8_TEXT = as.character(Pol_Ornt_8_TEXT),
         skept_open = as.character(skept_open),
         skepticism = as.factor(skepticism),
         id = as.factor(id),
         framing_condition_DO = as.factor(framing_condition_DO),
         norm_condition_DO = as.factor(norm_condition_DO),
         consumer_behaviors = as.factor(consumer_behaviors),
         source = strrep("gen_UO", times = 1))
```


```{r inspect prescreen, results = 'hide', include = FALSE}
# Prescreen Data
str(pre_fall22, list.len = ncol(pre_fall22))
str(pre_winter23, list.len = ncol(pre_winter23))
str(pre_spring23, list.len = ncol(pre_spring23))
str(participant_list, list.len = ncol(participant_list))
```

Variables from prescreen:

* Values:
  + respecting, unity, protecting, preventing, equality, peace, justice, helpful, power, wealth, authority, influential, ambition, pleasures, enjoying, gratification

* Socially Desirable Responding:
  + honest, like, disturbing, regret, lose-out, rational, confident, lover, lies, cover-up, advantage, get-even, behind-back, private-talk, take-things, gossip

## Combine prescreen data

Specify unique variables to combine prescreen data sets
```{r prep prescreen dfs}
# Create unique full_name variable
pre_fall22$full_name <- paste(pre_fall22$first_name, pre_fall22$last_name, sep="_")

pre_winter23$full_name <- paste(pre_winter23$first_name, pre_winter23$last_name, sep="_")

pre_spring23$full_name <- paste(pre_spring23$first_name, pre_spring23$last_name, sep="_")

participant_list$full_name <- paste(participant_list$first_name, participant_list$last_name, sep="_")

# Create column indicating which data set rows came from

pre_fall22 <- pre_fall22 %>%
  mutate(term = "fall22")

pre_winter23 <- pre_winter23 %>%
  mutate(term = "winter23")

pre_spring23 <- pre_spring23 %>%
  mutate(term = "spring23")
```

Combine prescreen data
```{r combine prescreen dfs}
combine1 <- smartbind(pre_fall22, pre_winter23)
combined_prescreen <- smartbind(combine1, pre_spring23)

# nrow(pre_fall22) + nrow(pre_winter23) + nrow(pre_spring23) # n = 1167

combined_prescreen_unique <- combined_prescreen[!duplicated(combined_prescreen$full_name), ] # keeps first row (fall22)
```

Subset key variables
```{r subset key vars}
combined_prescreen_key <- combined_prescreen_unique %>%
  dplyr::select(full_name, term, respecting:gratification, honest:gossip)

participant_list_key <- participant_list %>%
  dplyr::select(full_name, survey_id)
```

Merge with participant list
```{r merge participant list}
merged_prescreen <- merge(combined_prescreen_key, participant_list_key, by = "full_name")
```

Convert variable types in prescreen data
```{r inspect merged prescreen, results = 'hide', include = FALSE}
str(merged_prescreen, list.len = ncol(merged_prescreen))
```

Rename SDR items to match
```{r clean merged prescreen, warning = FALSE, include = FALSE}
merged_prescreen <- merged_prescreen %>%
  rename("lose_out" = "lose-out", 
         "cover_up" = "cover-up",
         "get_even" = "get-even",
         "behind_back" = "behind-back",
         "private_talk" = "private-talk",
         "take_things" = "take-things",
         "id" = "survey_id")
```

Convert variable types
```{r}
merged_prescreen <- merged_prescreen %>%
  mutate(respecting = as.integer(respecting),
         unity = as.integer(unity),
         protecting = as.integer(protecting),
         preventing = as.integer(preventing),
         equality = as.integer(equality),
         peace = as.integer(peace),
         justice = as.integer(justice),
         helpful = as.integer(helpful),
         power = as.integer(power),
         wealth = as.integer(wealth),
         authority = as.integer(authority),
         influential = as.integer(influential),
         ambition = as.integer(ambition),
         pleasures = as.integer(pleasures),
         enjoying = as.integer(enjoying),
         gratification = as.integer(gratification),
         honest = as.integer(honest),
         like = as.integer(like),
         disturbing = as.integer(disturbing),
         regret = as.integer(regret),
         lose_out = as.integer(lose_out),
         rational = as.integer(rational),
         confident = as.integer(confident),
         lover = as.integer(lover),
         lies = as.integer(lies),
         cover_up = as.integer(cover_up),
         advantage = as.integer(advantage),
         get_even = as.integer(get_even),
         behind_back = as.integer(behind_back),
         private_talk = as.integer(private_talk),
         take_things = as.integer(take_things),
         gossip = as.integer(gossip),
         id = as.factor(id))
```


Rename values & socially desirable items in prescreen data to match names in main data:
```{r rename prescreen vars, include = FALSE}
merged_prescreen <- merged_prescreen %>%
  rename("values_1" = "respecting",
         "values_2" = "unity",
         "values_3" = "protecting",
         "values_4" = "preventing",
         "values_5" = "equality",
         "values_6" = "peace",
         "values_7" = "justice",
         "values_8" = "helpful",
         "values_9" = "power",
         "values_10" = "wealth",
         "values_11" = "authority",
         "values_12" = "influential",
         "values_13" = "ambition",
         "values_14" = "pleasures",
         "values_15" = "enjoying",
         "values_16" = "gratification",
         "socially_desirable_1" = "honest",
         "socially_desirable_2" = "like",
         "socially_desirable_3" = "disturbing",
         "socially_desirable_4" = "regret",
         "socially_desirable_5" = "lose_out",
         "socially_desirable_6" = "rational",
         "socially_desirable_7" = "confident",
         "socially_desirable_8" = "lover",
         "socially_desirable_9" = "lies",
         "socially_desirable_10" = "cover_up",
         "socially_desirable_11" = "advantage",
         "socially_desirable_12" = "get_even",
         "socially_desirable_13" = "behind_back",
         "socially_desirable_14" = "private_talk",
         "socially_desirable_15" = "take_things",
         "socially_desirable_16" = "gossip")
```


## Combine all data

- First, combine Psych Hum Subj data with Prescreen data based on `id`
- Second, add Mktg Hum Subj data
- Third, add gen UO Pop data
```{r combine all data}
combine1 <- merge(raw_psych_hum_subj, merged_prescreen, by = "id")
combine2 <- smartbind(combine1, raw_mktg_hum_subj)
combine3 <- smartbind(combine2, raw_gen_uo_pop)
```

## Remove duplicate cases

Identify duplicate cases
```{r id duplicate cases, results = 'hide'}
# first, add unique row #s
combine3 <- combine3 %>%
  mutate(row = 1:nrow(combine3))

combine3[duplicated(combine3$id),] # Only rows 1 through 858 have unique id #s

# write.csv(combine3, "combined_data.csv")
```

Row IDs to remove:

* 13 (participant's second time completing study)
* 134 (participant didn't complete study first time)
* 145 (participant didn't complete study first time)
* 308 (participant's second time completing study)
* 672 (participant's second time completing study)
* 743 (participant didn't complete study first time)
* 790 (participant didn't complete study first time)
* 800 (participant didn't complete study first time)

Remove duplicate rows after resolving:
```{r remove duplicate cases}
combine3 <- combine3 %>%
  filter(!row %in% c(13, 134, 145, 308, 672, 743, 790, 800))
```

```{r inspect var types again, results = 'hide', include = FALSE}
str(combine3, list.len = ncol(combine3))
```

## Remove rows of all NAs

Identify completely missing rows:
```{r id all NA rows, results = 'hide'}
key_vars <- combine3 %>%
  dplyr::select(row, big_2_1:big_2_65, consumer_intentions_1:consumer_intentions_9, consumer_behaviors, clothing_interest_1:clothing_interest_20, ingroup_ident_1:ingroup_ident_14, values_1:values_16, socially_desirable_1:socially_desirable_16, source)

ncol(key_vars) # number of columns - the row # & source column = 141

all_NA_rows <- key_vars[rowSums(is.na(key_vars)) == 141,] # identify rows with 141 NAs (all missing values), row numbers are preserved

all_NA_rows
```

Removing rows of fully missing data
```{r remove all NA rows}
data <- combine3 %>%
  dplyr::filter(!row %in% c(859, 860, 900, 926, 927, 941, 1139, 1141, 1142, 1143, 1144, 1146, 1149, 1150, 1152)) %>% # remove rows containing all NAs
  dplyr::select(-StartDate, -EndDate, -Status, -Progress, -"Duration (in seconds)", -Finished, -RecordedDate, -ResponseId, -DistributionChannel, -UserLanguage, -big_2_DO, -consumer_intentions_DO, -consumer_behaviors_DO, -clothing_interest_DO, -ingroup_ident_DO, -full_name, -code, -socially_desirable_DO, -values_DO, -email_giftcard, -term) # removing variables not in analysis
```


Number per source
```{r}
table(data$source)
```

* 850 = psych human subjects pool
* 276 = mktg human subjects pool
* 7 = general UO pop


Rename variables
```{r rename vars}
data <- data %>%
  rename("framing_condition" = "framing_condition_DO", 
         "norm_condition" = "norm_condition_DO")

levels(data$framing_condition)
levels(data$norm_condition)

data$framing_condition <- droplevels(data$framing_condition)
data$norm_condition <- droplevels(data$norm_condition)

levels(data$framing_condition)
levels(data$norm_condition)

levels(data$skepticism)
```

## Inspect final data 
```{r inspect final df, results = 'hide'}
str(data, list.len = ncol(data))

# write.csv(data, "final_data.csv")
```

# Outliers & Missingness

## Univariate Outliers

Detecting potential data entry outliers:
```{r id outliers, echo = FALSE}
# Descriptives
data %>%
  select_if(is.integer) %>%
  describe()
```

Check if any values fall outside of possible scale options.

Boxplots
```{r boxplot outliers, eval = FALSE, include = FALSE}
# consumer intentions
data %>%
  dplyr::select(consumer_intentions_1:consumer_intentions_9) %>%
  boxplot()

# clothing interest
data %>%
  dplyr::select(clothing_interest_1:clothing_interest_20) %>%
  boxplot()

# ingroup identification
data %>%
  dplyr::select(ingroup_ident_1:ingroup_ident_14) %>%
  boxplot()

# personal values
data %>%
  dplyr::select(values_1:values_16) %>%
  boxplot()

# socially desirable responding
data %>%
  dplyr::select(socially_desirable_1:socially_desirable_16) %>%
  boxplot()
```


Histograms
```{r hist outliers, eval = FALSE, include = FALSE}
# consumer intentions
data %>%
  dplyr::select(consumer_intentions_1:consumer_intentions_9) %>%
  hist.data.frame()

# clothing interest
data %>%
  dplyr::select(clothing_interest_1:clothing_interest_10) %>%
  hist.data.frame()

data %>%
  dplyr::select(clothing_interest_11:clothing_interest_20) %>%
  hist.data.frame()

# ingroup identification
data %>%
  dplyr::select(ingroup_ident_1:ingroup_ident_7) %>%
  hist.data.frame()

data %>%
  dplyr::select(ingroup_ident_8:ingroup_ident_14) %>%
  hist.data.frame()

# personal values
data %>%
  dplyr::select(values_1:values_8) %>%
  hist.data.frame()

data %>%
  dplyr::select(values_9:values_16) %>%
  hist.data.frame()

# socially desirable responding
data %>%
  dplyr::select(socially_desirable_1:socially_desirable_8) %>%
  hist.data.frame()

data %>%
  dplyr::select(socially_desirable_9:socially_desirable_16) %>%
  hist.data.frame()
```


Demographics

Age
```{r age outliers, echo = FALSE}
# Age
data %>%
  dplyr::select(Age) %>%
  hist()
```

Income

- 1 = $0-9,999
- 2 = $10,000 - 19,999
- 3 = $20,000 - 29,999
- 4 = $30,000 - 39,999
- 5 = $40,000 - 49.999
- 6 = $50,000 - 59,999
- 7 = $60,000 - 69,999
- 8 = $70,000 - 79,999
- 9 = $80,000 - 89,999
- 10 = $90,000 - 99,999
- 11 = $100,000 or more
```{r income outliers}
data %>%
  dplyr::select(Income) %>%
  boxplot()

describe(data$Income)

table(data$Income)

data %>%
  filter(Income == 11 | Income == 10 | Income == 9 | Income == 8 | Income == 7) %>%
  dplyr::select(Income, Age, Employment, Class_Lvl)
```

Employment

- 1 = Employed, working 1-39 hrs/wk
- 2 = Employed, working 40+ hrs/wk
- 3 = Not employed, looking for work
- 4 = Not employed, NOT looking for work
- 5 = Retired
- 6 = Not able to work

Class Level

- 1 = Freshman
- 2 = Sophomore
- 3 = Junior
- 4 = Senior
- 5 = Graduate student
- 6 = Not applicable
- 7 = Other


Gender

- 1 = woman
- 2 = man
- 3 = non-binary
- 4 = I prefer not to identify
- 5 = other (please specify)
```{r label gender levels}
levels(data$Gender) <- c("Woman", "Man", "Non-binary", "I prefer not to identify", "Other")

table(data$Gender) 

data %>%
  filter(Gender == 5) %>%
  dplyr::select(Gender_5_TEXT)
```



## Missing Values

### Consumer Intentions & Behaviors
```{r NAs on consumer intentions & behaviors, include = FALSE}
data %>%
  dplyr::select(consumer_intentions_1:consumer_behaviors) %>%
  vis_miss()
```

### Clothing Interest
```{r NAs on clothing interest}
data %>%
  dplyr::select(clothing_interest_1:clothing_interest_20) %>%
  vis_miss()
```

### Ingroup Identification
```{r NAs on ingroup ident}
data %>%
  dplyr::select(ingroup_ident_1:ingroup_ident_14) %>%
  vis_miss()
```

### Values
```{r NAs on values}
data %>%
  dplyr::select(values_1:values_16) %>%
  vis_miss()
```

### Socially Desirable Responding
```{r NAs on SDR}
data %>%
  dplyr::select(socially_desirable_1:socially_desirable_16) %>%
  vis_miss()
```

### Demographics
```{r NAs on age, gender, income}
data %>%
  dplyr::select(Age, Gender, Income) %>%
  vis_miss()
```

### Personality
```{r NAs on personality}
data %>%
  dplyr::select(big_2_1:big_2_65) %>%
  vis_miss()
```

### All variables
```{r NAs on all variables}
data %>%
  dplyr::select(consumer_intentions_1:consumer_behaviors, clothing_interest_1:clothing_interest_20, ingroup_ident_1:ingroup_ident_14, values_1:values_16, socially_desirable_1:socially_desirable_16, Age, Gender, Income, big_2_1:big_2_65) %>%
  vis_miss(sort_miss = TRUE)
```

Less than 1% of total data is missing (0.8% missing).

### MCAR Test

A non-significant test suggests the data *is* missing completely at random.
```{r MCAR test, eval = FALSE}
test_of_mcar <- data %>%
  dplyr::select(consumer_intentions_1:consumer_behaviors, clothing_interest_1:clothing_interest_20, ingroup_ident_1:ingroup_ident_14, values_1:values_16, socially_desirable_1:socially_desirable_16, Age, Gender, Income, big_2_1:big_2_65) %>%
  mcar_test()

test_of_mcar$statistic
test_of_mcar$df # Critical values are 8565.53 and 9086.26
test_of_mcar$p.value
```

The test is non-significant, so we can assume the missingness is MCAR. Could also follow this up by seeing whether missingness can be predicted by any of the other variables in the model. 



# Aggregate Variables 

## Personality

### Reverse-code

```{r reverse personality items}
data_R <- data %>%
  mutate(across(c(big_2_11,
                  big_2_16,
                  big_2_26,
                  big_2_31,
                  big_2_36,
                  big_2_51,
                  big_2_12,
                  big_2_17,
                  big_2_22,
                  big_2_37,
                  big_2_42,
                  big_2_47,
                  big_2_3,
                  big_2_8,
                  big_2_23,
                  big_2_28,
                  big_2_48,
                  big_2_58,
                  big_2_4,
                  big_2_9,
                  big_2_24,
                  big_2_29,
                  big_2_44,
                  big_2_49,
                  big_2_5,
                  big_2_25,
                  big_2_30,
                  big_2_45,
                  big_2_50,
                  big_2_55,
                  big_2_63), ~6 - .)) # replace '6' with the max possible value plus 1 for any particular scale
```

### Average items

```{r aggregate personality}
data_R$extraversion <- data_R %>%
  dplyr::select(big_2_1, big_2_6, big_2_11, big_2_16, big_2_21, big_2_26, big_2_31, big_2_36, big_2_41, big_2_46, big_2_51, big_2_56) %>%
  rowMeans(na.rm = TRUE) 


data_R$conscientiousness <- data_R %>%
  dplyr::select(big_2_3, big_2_8, big_2_13, big_2_18, big_2_23, big_2_28, big_2_33, big_2_38, big_2_43, big_2_48, big_2_53, big_2_58) %>%
  rowMeans(na.rm = TRUE)


data_R$agreeableness <- data_R %>%
  dplyr::select(big_2_2, big_2_7, big_2_12, big_2_17, big_2_22, big_2_27, big_2_32, big_2_37, big_2_42, big_2_47, big_2_52, big_2_57) %>%
  rowMeans(na.rm = TRUE)


data_R$neuroticism <- data_R %>%
  dplyr::select(big_2_4, big_2_9, big_2_14, big_2_19, big_2_24, big_2_29, big_2_34, big_2_39, big_2_44, big_2_49, big_2_54, big_2_59) %>%
  rowMeans(na.rm = TRUE)


data_R$openness <- data_R %>%
  dplyr::select(big_2_5, big_2_10, big_2_15, big_2_20, big_2_25, big_2_30, big_2_35, big_2_40, big_2_45, big_2_50, big_2_55, big_2_60) %>%
  rowMeans(na.rm = TRUE)


data_R$honesty <- data_R %>%
  dplyr::select(big_2_61, big_2_62, big_2_63, big_2_64, big_2_65) %>%
  rowMeans(na.rm = TRUE)
```

### Visually inspect
```{r warning = FALSE}
data_R %>%
  dplyr::select(extraversion, agreeableness, conscientiousness, openness, neuroticism, honesty) %>%
  hist()
```

### Scale reliability

```{r alpha personality traits, echo = FALSE}
# Extraversion items
alpha_ext <- data_R %>%
  dplyr::select(big_2_1, big_2_6, big_2_11, big_2_16, big_2_21, big_2_26, big_2_31, big_2_36, big_2_41, big_2_46, big_2_51, big_2_56) %>%
  psych::alpha()

# Conscientiousness items
alpha_cons <- data_R %>%
  dplyr::select(big_2_3, big_2_8, big_2_13, big_2_18, big_2_23, big_2_28, big_2_33, big_2_38, big_2_43, big_2_48, big_2_53, big_2_58) %>%
  psych::alpha()

# Agreeableness items
alpha_agree <- data_R %>%
  dplyr::select(big_2_2, big_2_7, big_2_12, big_2_17, big_2_22, big_2_27, big_2_32, big_2_37, big_2_42, big_2_47, big_2_52, big_2_57) %>%
  psych::alpha()

# Neuroticism items
alpha_neur <- data_R %>%
  dplyr::select(big_2_4, big_2_9, big_2_14, big_2_19, big_2_24, big_2_29, big_2_34, big_2_39, big_2_44, big_2_49, big_2_54, big_2_59) %>%
  psych::alpha()

# Openness items
alpha_open <- data_R %>%
  dplyr::select(big_2_5, big_2_10, big_2_15, big_2_20, big_2_25, big_2_30, big_2_35, big_2_40, big_2_45, big_2_50, big_2_55, big_2_60) %>%
  psych::alpha()

# Honesty items
alpha_hone <- data_R %>%
  dplyr::select(big_2_61, big_2_62, big_2_63, big_2_64, big_2_65) %>%
  psych::alpha()

alpha_ext
alpha_cons
alpha_agree
alpha_neur
alpha_open
alpha_hone
```


## Clothing Interest

### Reverse-code

```{r reverse clothing items}
data_R <- data_R %>%
  mutate(across(c(clothing_interest_3,
                  clothing_interest_5,
                  clothing_interest_7,
                  clothing_interest_9,
                  clothing_interest_12,
                  clothing_interest_14,
                  clothing_interest_15,
                  clothing_interest_16,
                  clothing_interest_18,
                  clothing_interest_20), ~6 - .)) # replace '#' with the max possible value plus 1 for any particular scale
```


### Average items
```{r aggregate clothing interest}
data_R$clothing_interest <- data_R %>%
  dplyr::select(clothing_interest_1:clothing_interest_20) %>%
  rowMeans(na.rm = TRUE)
```

### Visually Inspect
```{r}
data_R %>%
  dplyr::select(clothing_interest) %>%
  hist()
```

### Scale reliability
```{r alpha clothing interest, echo = FALSE}
alpha_cloth <- data_R %>%
  dplyr::select(clothing_interest_1:clothing_interest_20) %>%
  psych::alpha()

alpha_cloth
```


## In-group Identification

### Reverse-code

No items need to be reverse-coded.

### Average items
```{r aggegate ingroup ident}
data_R$ingroup_identification <- data_R %>%
  dplyr::select(ingroup_ident_1:ingroup_ident_14) %>%
  rowMeans(na.rm = TRUE)
```

### Visually Inspect

```{r}
data_R %>%
  dplyr::select(ingroup_identification) %>%
  hist()
```


### Scale reliability
```{r alpha ingroup ident, echo = FALSE}
alpha_ingroup <- data_R %>%
  dplyr::select(ingroup_ident_1:ingroup_ident_14) %>%
  psych::alpha()

alpha_ingroup
```


## Values

### Reverse-code

No items need to be reverse-coded.

### Recoding scale options

Recoding values:

* -3 = 1
* -2 = 2
* -1 = 3
* 0 = 4
* +1 = 5
* +2 = 6
* +3 = 7

```{r recode values}
table(data_R$values_1)

data_R$values_1_rec <- recode(data_R$values_1, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)

table(data_R$values_1_rec)

data_R$values_2_rec <- recode(data_R$values_2, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_3_rec <- recode(data_R$values_3, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_4_rec <- recode(data_R$values_4, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_5_rec <- recode(data_R$values_5, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_6_rec <- recode(data_R$values_6, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_7_rec <- recode(data_R$values_7, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_8_rec <- recode(data_R$values_8, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_9_rec <- recode(data_R$values_9, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_10_rec <- recode(data_R$values_10, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_11_rec <- recode(data_R$values_11, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_12_rec <- recode(data_R$values_12, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_13_rec <- recode(data_R$values_13, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_14_rec <- recode(data_R$values_14, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_15_rec <- recode(data_R$values_15, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)
data_R$values_16_rec <- recode(data_R$values_16, `-3` = 1, `-2` = 2, `-1` = 3, `0` = 4, `1` = 5, `2` = 6, `3` = 7)

table(data_R$values_16)
table(data_R$values_16_rec)
```


### Average items
```{r aggregate values}
data_R$biospheric <- data_R %>%
  dplyr::select(values_1_rec:values_4_rec) %>%
  rowMeans(na.rm = TRUE)

data_R$altruistic <- data_R %>%
  dplyr::select(values_5_rec:values_8_rec) %>%
  rowMeans(na.rm = TRUE)

data_R$egoistic <- data_R %>%
  dplyr::select(values_9_rec:values_13_rec) %>%
  rowMeans(na.rm = TRUE)

data_R$hedonic <- data_R %>%
  dplyr::select(values_14_rec:values_16_rec) %>%
  rowMeans(na.rm = TRUE)
```

### Visually inspect
```{r}
values_df <- data_R %>%
  dplyr::select(biospheric, altruistic, egoistic, hedonic)

values_df %>%
  hist()
```

### Frequency tables
```{r}
# Biospheric values
tab1(values_df$biospheric, sort.group = "descending", cum.percent = TRUE, missing = FALSE, horiz = TRUE)

# Altruistic values
tab1(values_df$altruistic, sort.group = "descending", cum.percent = TRUE, missing = FALSE, horiz = TRUE)

# Egoistic values
tab1(values_df$egoistic, sort.group = "descending", cum.percent = TRUE, missing = FALSE, horiz = TRUE)

# Hedonic values
tab1(values_df$hedonic, sort.group = "descending", cum.percent = TRUE, missing = FALSE, horiz = TRUE)
```

### Scale reliability
```{r alpha values, echo = FALSE}
alpha_biospheric <- data_R %>%
  dplyr::select(values_1_rec:values_4_rec) %>%
  psych::alpha()

alpha_altruistic <- data_R %>%
  dplyr::select(values_5_rec:values_8_rec) %>%
  psych::alpha()

alpha_egoistic <- data_R %>%
  dplyr::select(values_9_rec:values_13_rec) %>%
  psych::alpha()

alpha_hedonic <- data_R %>%
  dplyr::select(values_14_rec:values_16_rec) %>%
  psych::alpha()

alpha_biospheric
alpha_altruistic
alpha_egoistic
alpha_hedonic
```



## Socially Desirable Responding

### Reverse-code
```{r reverse code socially desirable items}
data_R <- data_R %>%
  mutate(across(c(socially_desirable_1,
                  socially_desirable_3,
                  socially_desirable_5,
                  socially_desirable_8,
                  socially_desirable_9,
                  socially_desirable_11,
                  socially_desirable_12,
                  socially_desirable_13), ~8 - .)) # replace '#' with the max possible value plus 1 for any particular scale
```

### Average items
```{r aggregate socially desirable}
data_R$self_deceptive_sdr <- data_R %>%
  dplyr::select(socially_desirable_1:socially_desirable_8) %>%
  rowMeans(na.rm = TRUE)
  
data_R$impress_manag_sdr <- data_R %>%
  dplyr::select(socially_desirable_9:socially_desirable_16) %>%
  rowMeans(na.rm = TRUE)
```

### Visually inspect

```{r warning = FALSE}
data_R %>%
  dplyr::select(self_deceptive_sdr, impress_manag_sdr) %>%
  hist()
```

### Scale reliability
```{r alpha socially desirable, echo = FALSE}
alpha_SDE_sdr <- data_R %>%
  dplyr::select(socially_desirable_1:socially_desirable_8) %>%
  psych::alpha()

alpha_IM_sdr <- data_R %>%
  dplyr::select(socially_desirable_9:socially_desirable_16) %>%
  psych::alpha()

alpha_SDE_sdr
alpha_IM_sdr
```


## Consumer Intentions

### Reverse-code

Higher scores mean better consumer intentions (intentions to *reduce* future consumption):
```{r reverse code consumer intentions}
data_R <- data_R %>%
  mutate(across(c(consumer_intentions_2,
                  consumer_intentions_4,
                  consumer_intentions_7,
                  consumer_intentions_9), ~8 - .)) # replace '#' with the max possible value plus 1 for any particular scale
```

### Average items

```{r aggregate consumer intentions}
data_R$consumer_intentions <- data_R %>%
  dplyr::select(consumer_intentions_1:consumer_intentions_9) %>%
  rowMeans(na.rm = TRUE)
```

### Visually inspect

```{r warning = FALSE}
data_R %>%
  dplyr::select(consumer_intentions) %>%
  hist()
```

### Scale reliability

```{r alpha consumer intentions, echo = FALSE}
alpha_cons_int <- data_R %>%
  dplyr::select(consumer_intentions_1:consumer_intentions_9) %>%
  psych::alpha()

alpha_cons_int
```

### Reorder levels

Reorder the levels of norm condition:
```{r reorder norm condition levels}
data_R %>%
  group_by(norm_condition) %>%
  summarize(M = mean(consumer_intentions, na.rm = TRUE))

data_R$norm_condition <- ordered(data_R$norm_condition, levels = c("control_norm", "descriptive_norm", "convention_norm", "social_norm", "moral_norm"))
```




# Descriptive Statistics

```{r}
describe(data_R)
```


## Consumer Intentions
```{r descriptives consumer intentions, echo = FALSE}
# by framing condition
cons_int_D <- data_R %>%
  group_by(framing_condition) %>% 
  summarize(n = n(),
            M_ConsumerIntentions = mean(consumer_intentions, na.rm = TRUE),
            SD_ConsumerIntentions = sd(consumer_intentions, na.rm = TRUE))

knitr::kable(cons_int_D, digits = 2, caption = "Descriptives for Consumer Intentions by Framing Condition")


# by norm condition
cons_int_D2 <- data_R %>%
  group_by(norm_condition) %>% 
  summarize(n = n(),
            M_ConsumerIntentions = mean(consumer_intentions, na.rm = TRUE),
            SD_ConsumerIntentions = sd(consumer_intentions, na.rm = TRUE))

knitr::kable(cons_int_D2, digits = 2, caption = "Descriptives for Consumer Intentions by Norm Condition")


# cell means
cons_int_D3 <- data_R %>%
  group_by(framing_condition, norm_condition) %>% 
  summarize(n = n(),
            M_ConsumerIntentions = mean(consumer_intentions, na.rm = TRUE),
            SD_ConsumerIntentions = sd(consumer_intentions, na.rm = TRUE))

knitr::kable(cons_int_D3, digits = 2, caption = "Descriptives for Consumer Intentions by Framing X Norm Condition")
```


## Ingroup Identification
```{r descriptives ingroup ident, echo = FALSE}
# Ingroup Identification
ingroup_D <- data_R %>%
  group_by(framing_condition) %>% 
  summarize(n = n(),
            M_IngroupIdentification = mean(ingroup_identification, na.rm = TRUE),
            SD_IngroupIdentification = sd(ingroup_identification, na.rm = TRUE))

knitr::kable(ingroup_D, digits = 2, caption = "Descriptives for Ingroup Identification by Framing Condition")


ingroup_D2 <- data_R %>%
  group_by(norm_condition) %>% 
  summarize(n = n(),
            M_IngroupIdentification = mean(ingroup_identification, na.rm = TRUE),
            SD_IngroupIdentification = sd(ingroup_identification, na.rm = TRUE))

knitr::kable(ingroup_D2, digits = 2, caption = "Descriptives for Ingroup Identification by Norm Condition")



ingroup_D3 <- data_R %>%
  group_by(framing_condition, norm_condition) %>% 
  summarize(n = n(),
            M_IngroupIdentification = mean(ingroup_identification, na.rm = TRUE),
            SD_IngroupIdentification = sd(ingroup_identification, na.rm = TRUE))

knitr::kable(ingroup_D3, digits = 2, caption = "Descriptives for Ingroup Identification by Framing X Norm Condition")

```

## Values
```{r descriptives values, echo = FALSE}
# Values
values_D <- data_R %>%
  group_by(framing_condition) %>% 
  summarize(n = n(),
            M_Biospheric = mean(biospheric, na.rm = TRUE),
            SD_Biospheric = sd(biospheric, na.rm = TRUE),
            M_Altruistic = mean(altruistic, na.rm = TRUE),
            SD_Altruistic = sd(altruistic, na.rm = TRUE),
            M_Egoistic = mean(egoistic, na.rm = TRUE),
            SD_Egoistic = sd(egoistic, na.rm = TRUE),
            M_Hedonic = mean(hedonic, na.rm = TRUE),
            SD_Hedonic = sd(hedonic, na.rm = TRUE))

knitr::kable(values_D, digits = 2, caption = "Descriptives for Values by Framing Condition")


values_D2 <- data_R %>%
  group_by(norm_condition) %>% 
  summarize(n = n(),
            M_Biospheric = mean(biospheric, na.rm = TRUE),
            SD_Biospheric = sd(biospheric, na.rm = TRUE),
            M_Altruistic = mean(altruistic, na.rm = TRUE),
            SD_Altruistic = sd(altruistic, na.rm = TRUE),
            M_Egoistic = mean(egoistic, na.rm = TRUE),
            SD_Egoistic = sd(egoistic, na.rm = TRUE),
            M_Hedonic = mean(hedonic, na.rm = TRUE),
            SD_Hedonic = sd(hedonic, na.rm = TRUE))

knitr::kable(values_D2, digits = 2, caption = "Descriptives for Values by Norm Condition")



values_D3 <- data_R %>%
  group_by(framing_condition, norm_condition) %>% 
  summarize(n = n(),
            M_Biospheric = mean(biospheric, na.rm = TRUE),
            SD_Biospheric = sd(biospheric, na.rm = TRUE),
            M_Altruistic = mean(altruistic, na.rm = TRUE),
            SD_Altruistic = sd(altruistic, na.rm = TRUE),
            M_Egoistic = mean(egoistic, na.rm = TRUE),
            SD_Egoistic = sd(egoistic, na.rm = TRUE),
            M_Hedonic = mean(hedonic, na.rm = TRUE),
            SD_Hedonic = sd(hedonic, na.rm = TRUE))

knitr::kable(values_D3, digits = 2, caption = "Descriptives for Values by Framing X Norm Condition")

```

## Clothing Interest
```{r descriptives clothing interest, echo = FALSE}
# Clothing Interest
clothing_D <- data_R %>%
  group_by(framing_condition) %>% 
  summarize(n = n(),
            M_ClothingInterest = mean(clothing_interest, na.rm = TRUE),
            SD_ClothingInterest = sd(clothing_interest, na.rm = TRUE))

knitr::kable(clothing_D, digits = 2, caption = "Descriptives for Clothing Interest by Framing Condition")


clothing_D2 <- data_R %>%
  group_by(norm_condition) %>% 
  summarize(n = n(),
            M_ClothingInterest = mean(clothing_interest, na.rm = TRUE),
            SD_ClothingInterest = sd(clothing_interest, na.rm = TRUE))

knitr::kable(clothing_D2, digits = 2, caption = "Descriptives for Clothing Interest by Norm Condition")


clothing_D3 <- data_R %>%
  group_by(framing_condition, norm_condition) %>% 
  summarize(n = n(),
            M_ClothingInterest = mean(clothing_interest, na.rm = TRUE),
            SD_ClothingInterest = sd(clothing_interest, na.rm = TRUE))

knitr::kable(clothing_D3, digits = 2, caption = "Descriptives for Clothing Interest by Framing X Norm Condition")

```

## Socially Desirable Responding
```{r descriptives soc des resp, echo = FALSE}
# Socially Desirable Responding
sde_sdr_D <- data_R %>%
  group_by(framing_condition) %>% 
  summarize(n = n(),
            M_SDE_SDR = mean(self_deceptive_sdr, na.rm = TRUE),
            SD_SDE_SDR = sd(self_deceptive_sdr, na.rm = TRUE))

knitr::kable(sde_sdr_D, digits = 2, caption = "Descriptives for Self Deceptive Socially Desirable Responding by Framing Condition")

im_sdr_D <- data_R %>%
  group_by(framing_condition) %>% 
  summarize(n = n(),
            M_IM_SDR = mean(impress_manag_sdr, na.rm = TRUE),
            SD_IM_SDR = sd(impress_manag_sdr, na.rm = TRUE))

knitr::kable(im_sdr_D, digits = 2, caption = "Descriptives for Impression Management Socially Desirable Responding by Framing Condition")


sde_sdr_D2 <- data_R %>%
  group_by(norm_condition) %>% 
  summarize(n = n(),
            M_SDE_SDR = mean(self_deceptive_sdr, na.rm = TRUE),
            SD_SDE_SDR = sd(self_deceptive_sdr, na.rm = TRUE))

knitr::kable(sde_sdr_D2, digits = 2, caption = "Descriptives for Self Deceptive Socially Desirable Responding by Norm Condition")

im_sdr_D2 <- data_R %>%
  group_by(norm_condition) %>% 
  summarize(n = n(),
            M_IM_SDR = mean(impress_manag_sdr, na.rm = TRUE),
            SD_IM_SDR = sd(impress_manag_sdr, na.rm = TRUE))

knitr::kable(im_sdr_D2, digits = 2, caption = "Descriptives for Impression Management Socially Desirable Responding by Norm Condition")

```

## Personality 
```{r descriptives personality, echo = FALSE}
# Personality
pers_D <- data_R %>%
  group_by(framing_condition) %>%
  summarize(n = n(),
            M_E = mean(extraversion, na.rm = TRUE),
            SD_E = sd(extraversion, na.rm = TRUE),
            M_C = mean(conscientiousness, na.rm = TRUE),
            SD_C = sd(conscientiousness, na.rm = TRUE),
            M_A = mean(agreeableness, na.rm = TRUE),
            SD_A = sd(agreeableness, na.rm = TRUE),
            M_N = mean(neuroticism, na.rm = TRUE),
            SD_N = sd(neuroticism, na.rm = TRUE),
            M_O = mean(openness, na.rm = TRUE),
            SD_O = sd(openness, na.rm = TRUE),
            M_H = mean(honesty, na.rm = TRUE),
            SD_H = sd(honesty, na.rm = TRUE))

knitr::kable(pers_D, digits = 2, caption = "Descriptives for Personality Traits by Framing Condition")


pers_D2 <- data_R %>%
  group_by(norm_condition) %>%
  summarize(n = n(),
            M_E = mean(extraversion, na.rm = TRUE),
            SD_E = sd(extraversion, na.rm = TRUE),
            M_C = mean(conscientiousness, na.rm = TRUE),
            SD_C = sd(conscientiousness, na.rm = TRUE),
            M_A = mean(agreeableness, na.rm = TRUE),
            SD_A = sd(agreeableness, na.rm = TRUE),
            M_N = mean(neuroticism, na.rm = TRUE),
            SD_N = sd(neuroticism, na.rm = TRUE),
            M_O = mean(openness, na.rm = TRUE),
            SD_O = sd(openness, na.rm = TRUE),
            M_H = mean(honesty, na.rm = TRUE),
            SD_H = sd(honesty, na.rm = TRUE))

knitr::kable(pers_D2, digits = 2, caption = "Descriptives for Personality Traits by Norm Condition")


pers_D3 <- data_R %>%
  group_by(framing_condition, norm_condition) %>%
  summarize(n = n(),
            M_E = mean(extraversion, na.rm = TRUE),
            SD_E = sd(extraversion, na.rm = TRUE),
            M_C = mean(conscientiousness, na.rm = TRUE),
            SD_C = sd(conscientiousness, na.rm = TRUE),
            M_A = mean(agreeableness, na.rm = TRUE),
            SD_A = sd(agreeableness, na.rm = TRUE),
            M_N = mean(neuroticism, na.rm = TRUE),
            SD_N = sd(neuroticism, na.rm = TRUE),
            M_O = mean(openness, na.rm = TRUE),
            SD_O = sd(openness, na.rm = TRUE),
            M_H = mean(honesty, na.rm = TRUE),
            SD_H = sd(honesty, na.rm = TRUE))

knitr::kable(pers_D3, digits = 2, caption = "Descriptives for Personality Traits by Framing X Norm Condition")

```

## Consumer Behaviors

* consumer_behaviors
  + 1 = I would like to enter into the raffle for a $50 gift card to spend on **new clothing items.**
  + 2 = I would like to enter into the raffle for a $50 gift card to spend on **secondhand clothing items.**


Label levels of consumer behaviors:
```{r label levels of consumer behaviors, echo = FALSE, warning = FALSE}
levels(data_R$consumer_behaviors) <- c("New Clothing", "Secondhand Clothing")
```

### Table of Proportions
```{r descriptives consumer behaviors, echo = FALSE}
# by framing condition

## Frequency table
framing_main_behaviors <- data_R %>%
  group_by(framing_condition) %>%
  dplyr::select(consumer_behaviors) %>%
  table()

# Table of proportions (Contingency Table)
prop.table(framing_main_behaviors)


# by norm
## Frequency table
norm_main_behaviors <- data_R %>%
  group_by(norm_condition) %>%
  dplyr::select(consumer_behaviors) %>%
  table()

## Table of proportions (Contingency Table)
prop.table(norm_main_behaviors)


# by framing X norm condition
## Frequency table
int_effect_behaviors <- table(data_R$framing_condition, data_R$norm_condition)

## Proportions (Contingency Table)
prop.table(int_effect_behaviors)

```

### Marginals Tables
```{r proportions by row, echo = FALSE}
## Main Effect of Framing
prop.table(framing_main_behaviors, margin = 1) # Row percentages

## Main Effect of Norm
prop.table(norm_main_behaviors, margin = 1) # Row percentages

## Interaction Effect
prop.table(int_effect_behaviors, margin = 1) # Row percentages
```



## Skepticism

  + 1 = Yes
  + 2 = No

Q: Is skepticism higher in one of the framing and/or norm conditions compared to the others?

Label levels of skepticism:
```{r label skepticism, echo = FALSE, warning = FALSE}
levels(data_R$skepticism) <- c("Yes", "No")
```

### Table of Proportions
```{r skepticism table of props skept, echo = FALSE}
# by framing condition

## Frequency table
skepticism_by_framing <- data_R %>%
  group_by(framing_condition) %>%
  dplyr::select(skepticism) %>%
  table()

# Table of proportions (Contingency Table)
prop.table(skepticism_by_framing)


# by norm
## Frequency table
skepticism_by_norm <- data_R %>%
  group_by(norm_condition) %>%
  dplyr::select(skepticism) %>%
  table()

## Table of proportions (Contingency Table)
prop.table(skepticism_by_norm)

```

### Marginals Tables
```{r proportions by row skept, echo = FALSE}
## Main Effect of Framing
prop.table(skepticism_by_framing, margin = 1) # Row percentages

## Main Effect of Norm
prop.table(skepticism_by_norm, margin = 1) # Row percentages
```


## Scatterplot Matrix

Correlations between consumer intentions & all other variables:
```{r scatterplot matrix}
# Consumer intentions with ingroup identification, clothing interest, socially desirable, age
data_R %>%
  dplyr::select(consumer_intentions, ingroup_identification, clothing_interest, self_deceptive_sdr, impress_manag_sdr) %>%
  pairs(upper.panel = NULL)

# Consumer intentions with values
data_R %>%
  dplyr::select(consumer_intentions, biospheric, altruistic, egoistic, hedonic, Age) %>%
  pairs(upper.panel = NULL)
```



# Regression Analysis (DV = Consumer Intentions)

## Center Covariates

- Socially desirable responding
- Clothing interest
- Values
- Ingroup identification
- Age
- Gender
- Income (not sure how to handle inconsistencies in this variable was responded to)

```{r center covariates, echo = FALSE}
data_R$self_deceptive_center <- data_R$self_deceptive_sdr - mean(data_R$self_deceptive_sdr, na.rm = TRUE)

data_R$impress_manag_center <- data_R$impress_manag_sdr - mean(data_R$impress_manag_sdr, na.rm = TRUE)

data_R$clothing_interest_center <- data_R$clothing_interest - mean(data_R$clothing_interest, na.rm = TRUE)

data_R$Age_center <- data_R$Age - mean(data_R$Age, na.rm = TRUE)

data_R$ingroup_identification_center <- data_R$ingroup_identification - mean(data_R$ingroup_identification, na.rm = TRUE)

data_R$biospheric_center <- data_R$biospheric - mean(data_R$biospheric, na.rm = TRUE)

data_R$altruistic_center <- data_R$altruistic - mean(data_R$altruistic, na.rm = TRUE)

data_R$egoistic_center <- data_R$egoistic - mean(data_R$egoistic, na.rm = TRUE)

data_R$hedonic_center <- data_R$hedonic - mean(data_R$hedonic, na.rm = TRUE)

data_R$extraversion_center <- data_R$extraversion - mean(data_R$extraversion, na.rm = TRUE)
  
data_R$conscientiousness_center <- data_R$conscientiousness - mean(data_R$conscientiousness, na.rm = TRUE)

data_R$agreeableness_center <- data_R$agreeableness - mean(data_R$agreeableness, na.rm = TRUE)

data_R$neuroticism_center <- data_R$neuroticism - mean(data_R$neuroticism, na.rm = TRUE)

data_R$openness_center <- data_R$openness - mean(data_R$openness, na.rm = TRUE)

data_R$honesty_center <- data_R$honesty - mean(data_R$honesty, na.rm = TRUE)

```


```{r reduce levels of gender, echo = FALSE}
data_R$Gender[data_R$Gender == "Non-binary"] <- NA
data_R$Gender[data_R$Gender == "I prefer not to identify"] <- NA
data_R$Gender[data_R$Gender == "Other"] <- NA

data_R$Gender <- droplevels(data_R$Gender)
```


## Contrast Coding

```{r contrast coding 1}
# Gender
contrasts(data_R$Gender) <- c(-1/2, 1/2)
contrasts(data_R$Gender)

# Framing
FrameCode1 <- c(-1/2, 0, 1/2) # control vs self-enhancing
FrameCode2 <- c(-1/3, 2/3, -1/3) # arbitrary code

contrasts(data_R$framing_condition) <- cbind(FrameCode1, FrameCode2)
contrasts(data_R$framing_condition)

# Norm
contrasts(data_R$norm_condition) <- contr.helmert(5)
contrasts(data_R$norm_condition) # control vs DN

# Skepticism
contrasts(data_R$skepticism) <- c(-1/2, 1/2)
```


## Running Model
```{r full model consumer intentions}
full_model_1a <- lm(consumer_intentions ~ framing_condition*norm_condition*biospheric_center + framing_condition*norm_condition*altruistic_center + framing_condition*norm_condition*egoistic_center + framing_condition*norm_condition*hedonic_center + framing_condition*norm_condition*ingroup_identification_center + self_deceptive_center + impress_manag_center + clothing_interest_center + Gender + Age_center, data = data_R)
```


## Model Output

Full Summary
```{r full summary consumer intentions, include = FALSE}
regr_summary <- summary(full_model_1a)
summary(full_model_1a)
```

* 156 observations deleted due to missingness
* n = 977
* number of parameters = 94
* F(93, 883) = 3.541, p < .001, adj_R_sq = .195

### ANOVA Summary
```{r anova table consumer intentions}
anova(full_model_1a) %>%
  knitr::kable(digits = 3)
```

### Effect Sizes

#### Eta-Squared
```{r}
eta_squared(full_model_1a, ci = 0.95, alternative = "two.sided", partial = FALSE)
```

#### Partial Eta-Squared
```{r}
eta_squared(full_model_1a, ci = 0.95, alternative = "two.sided")
```


### Regression Summary
```{r pretty summary table consumer intentions, include = FALSE}
tab_model(full_model_1a, show.se = TRUE, show.fstat = TRUE)
```

```{r succinct summary consumer intentions}
regr_summary$coefficients %>%
  knitr::kable(digits = 3)
```











## Regression Diagnostics

### Checking non-linearity

First, assess non-linearity using a residuals plots:
```{r}
plot(full_model_1a, 1)
```

There does not appear to be a systematic pattern suggesting an uncaptured, non-linear trend.

### Checking non-normally distributed errors

Second, assess non-normally distributed errors by plotting the residuals & using a QQ-plot:
```{r}
# storing residuals
full_model_1a_aug <- augment(full_model_1a)

# plotting histogram of residuals
ggplot(data = full_model_1a_aug, aes(x = .resid)) + 
  geom_density(fill = "purple") + 
  stat_function(linetype = 2, 
                fun      = dnorm, 
                args     = list(mean = mean(full_model_1a_aug$.resid), 
                                sd   =   sd(full_model_1a_aug$.resid))) +
  theme_minimal()


# QQ-plot
ggplot(full_model_1a) +
  geom_abline(color = "turquoise4") + 
  stat_qq(aes(sample = .stdresid), color = "darkorchid4", alpha = .50) +
  theme_minimal()
```

The distribution of residuals & QQ-plot suggest approximately normally distributed residuals.

### Checking heteroscedasticity

Third, check for heteroscedasticity by looking at spread of residuals on residuals plot:
```{r}
plot(full_model_1a, 1)
```

There does not appear to be an issue with heteroscedasticity.


### Checking multivariate outliers

Outliers based on distance from model using standardized residuals:
```{r}
# using olsrr function
ols_plot_resid_stand(full_model_1a)


# or grabbing from model augment output
full_model_1a_aug <- augment(full_model_1a)

full_model_1a_aug$id <- full_model_1a_aug$.rownames

std_resids <- full_model_1a_aug %>% 
  dplyr::select(.rownames, .std.resid) %>%
  arrange(desc(abs(.std.resid)))

print(std_resids, n = 15)
```

Examine outliers with standardized residuals greater than +/-2 or +/-3.

Outliers based on influence on model using Cook's Distance:
```{r}
# using olsrr function
ols_plot_cooksd_chart(full_model_1a)

# or grabbing from model augment output
cooks_d <- full_model_1a_aug %>% 
  dplyr::select(.rownames, .cooksd) %>%
  arrange(desc(abs(.cooksd)))

print(cooks_d, n = 15)
```

One standard is that Cook's D values greater than 3 times the average Cook's D values are worth investigating.


### Checking multicollinearity

Using VIFs & tolerance:
```{r}
ols_vif_tol(full_model_1a) %>%
  arrange(desc(abs(VIF)))
```

Either a *low* tolerance (below 0.20 is one rule of thumb) or a *high* VIF (above 5 or 10) is an indication of a problem with multicollinearity.



## Simple Effects

### Framing Condition

>>H1: Consumer intentions/behaviors will be lower in the self-enhancing framing than in the pro-environmental or control framing conditions.

Comparing each level of framing condition:
```{r}
frame_means <- emmeans(full_model_1a, pairwise ~ framing_condition, adjust = "none")
frame_means

emmip(full_model_1a, ~ framing_condition, CIs = TRUE, xlab = "Framing Condition", ylab = "Consumer Intentions")
```

* Intentions are highest in the pro-environmental condition, but the difference between the pro-environmental and self-enhancing framings (t(883) = 1.20, p = .231) and the pro-environmental and control framing (t(883) = -1.66, p = .097) is not significant. 
* The difference between self-enhancing and control framing is also not significant, t(883) = -0.45, p = .651.


Effect Sizes (Cohen's D):
```{r}
eff_size(frame_means, sigma = sigma(full_model_1a), edf = df.residual(full_model_1a))
```


### Norm Condition

>>H2: Consumer intentions/behaviors will be lower in each norm condition compared to the control norm condition.

Comparing each level of norm condition:
```{r}
norm_means <- emmeans(full_model_1a, pairwise ~ norm_condition, adjust = "none")
norm_means

emmip(full_model_1a, ~ norm_condition, CIs = TRUE, xlab = "Norm Condition", ylab = "Consumer Intentions")
```

* There was no significant difference between any norm condition compared to the control condition (all ps > .216)

Effect Sizes (Cohen's D):
```{r}
eff_size(norm_means, sigma = sigma(full_model_1a), edf = df.residual(full_model_1a))
```


Exploratory finding:

* Intentions were significantly higher in the convention versus the social norm condition, t(883) = 1.60, p = .042. 



### Framing X Norm 

>>H3: There will be a two-way interaction between framing & norm condition such that the effect of each norm will be stronger in the self-enhancing framing than in the pro-environmental or control framing conditions.


Effect of norm condition at each level of framing condition:
```{r}
cell_means <- emmeans(full_model_1a, pairwise ~ norm_condition | framing_condition, adjust = "none")
cell_means

emmip(full_model_1a, framing_condition ~ norm_condition, CIs = FALSE, xlab = "Norm Condition", ylab = "Consumer Intentions")
```


* Differences between the control norm condition & other norm conditions were not significant within any of the framing conditions.


Effect Sizes (Cohen's D):
```{r}
eff_size(cell_means, sigma = sigma(full_model_1a), edf = df.residual(full_model_1a))
```

* The effect sizes are larger comparing the control norm condition to the other norm conditions within the self-enhancing framing condition compared to within the control framing or pro-environmental framing conditions
  + But, inspection of the cell means demonstrates that this is being driven by the fact that consumer intentions in the self-enhancing framing/control norm condition started out lower than the control norm condition in the other two framing conditions.



  
Comparing consumer intentions for each norm condition between each framing condition:
```{r}
# Control norm
chosen_values <- list(norm_condition = c("control_norm"), framing_condition = c("control_framing", "pro_env_framing", "self_enh_framing"))

control_norm_means <- emmeans(full_model_1a, pairwise ~ norm_condition*framing_condition, at = chosen_values, adjust = "none")

control_norm_means

eff_size(control_norm_means, sigma = sigma(full_model_1a), edf = df.residual(full_model_1a)) # cohen's d



# Descriptive norm
chosen_values <- list(norm_condition = c("descriptive_norm"), framing_condition = c("control_framing", "pro_env_framing", "self_enh_framing"))

descr_norm_means <- emmeans(full_model_1a, pairwise ~ norm_condition*framing_condition, at = chosen_values, adjust = "none")
descr_norm_means

eff_size(descr_norm_means, sigma = sigma(full_model_1a), edf = df.residual(full_model_1a)) # cohen's d


# Convention norm
chosen_values <- list(norm_condition = c("convention_norm"), framing_condition = c("control_framing", "pro_env_framing", "self_enh_framing"))

conv_norm_means <- emmeans(full_model_1a, pairwise ~ norm_condition*framing_condition, at = chosen_values, adjust = "none")
conv_norm_means

eff_size(conv_norm_means, sigma = sigma(full_model_1a), edf = df.residual(full_model_1a)) # cohen's d


# Social norm
chosen_values <- list(norm_condition = c("social_norm"), framing_condition = c("control_framing", "pro_env_framing", "self_enh_framing"))

soc_norm_means <- emmeans(full_model_1a, pairwise ~ norm_condition*framing_condition, at = chosen_values, adjust = "none")
soc_norm_means

eff_size(soc_norm_means, sigma = sigma(full_model_1a), edf = df.residual(full_model_1a)) # cohen's d


# Moral norm
chosen_values <- list(norm_condition = c("moral_norm"), framing_condition = c("control_framing", "pro_env_framing", "self_enh_framing"))

moral_norm_means <- emmeans(full_model_1a, pairwise ~ norm_condition*framing_condition, at = chosen_values, adjust = "none")
moral_norm_means

eff_size(moral_norm_means, sigma = sigma(full_model_1a), edf = df.residual(full_model_1a)) # cohen's d
```








### Values Interactions

>>H4: There will be a three-way interaction between values (biospheric, egoistic, altruistic, hedonic), framing condition, & norm condition such that when a pro-environmental or control framing is used, values will moderate the effect of each norm condition, but not when a self-enhancing framing is used.


### Biospheric Values


First, relationship between biospheric values & consumer intentions for each norm condition:
```{r}
emtrends(full_model_1a, ~norm_condition, var = "biospheric_center", adjust = "none")


# On a single graph
at_list <- list(biospheric_center = seq(-5, 1.3, by = 1))

emmip(full_model_1a, norm_condition ~ biospheric_center, at = at_list, CIs = TRUE, xlab = "Biospheric Values (centered)", ylab = "Consumer Intentions")
```

* Biospheric values was a significant, positive predictor of consumer intentions in all norm conditions except for the moral norm conditions in which it was a non-significant, positive predictor.



Is the slope of the relationship between biospheric values & consumer intentions stronger in any one of the norm conditions compared to the others?

```{r}
emtrends(full_model_1a, pairwise~norm_condition, var = "biospheric_center", adjust = "none")
```



Second, relationship between biospheric values & consumer intentions for each framing condition:
```{r}
emtrends(full_model_1a, ~framing_condition, var = "biospheric_center", adjust = "none")

# On a single graph
at_list <- list(biospheric_center = seq(-5, 1.3, by = 1))

emmip(full_model_1a, framing_condition ~ biospheric_center, at = at_list, CIs = TRUE, xlab = "Biospheric Values (centered)", ylab = "Consumer Intentions")
```

* Biospheric values were significantly, positively related to consumer intentions in all framing conditions.


Is the slope of the relationship between biospheric values & consumer intentions stronger in any one of the framing conditions compared to the others?

```{r}
emtrends(full_model_1a, pairwise~framing_condition, var = "biospheric_center", adjust = "none")
```


Third, interaction between biospheric values, framing, & norm condition:
```{r}
emtrends(full_model_1a, ~norm_condition | framing_condition, var = "biospheric_center", adjust = "none")

# Separate graph for each framing condition
at_list <- list(biospheric_center = seq(-5, 1.3, by = 1))

emmip(full_model_1a, norm_condition ~ biospheric_center | framing_condition, at = at_list, CIs = TRUE, xlab = "Biospheric Values (centered)", ylab = "Consumer Intentions")
```

* In the control framing condition, biospheric values were significantly, positively related to consumer intentions in the **control norm**, **descriptive norm**, and **convention** conditions but non-significantly, negatively related in the **social norm** and **moral norm** conditions.

* In the pro-environmental framing condition, biospheric values were significantly, positively realted to consumer intentions in the **convention**, **social norm** and **moral norm** conditions, and non-significantly, positively related in the **control norm** and **descriptive norm** conditions.

* In the self-enhancing framing condition, biospheric values were significantly, positively related to consumer intentions in the **control norm** condition, but non-significantly, positively related in all other norm conditions.





### Altruistic Values


First, relationship between altruistic values & consumer intentions for each norm condition:
```{r}
emtrends(full_model_1a, ~norm_condition, var = "altruistic_center", adjust = "none")


# On a single graph
at_list <- list(altruistic_center = seq(-5.4, 1, by = 1))

emmip(full_model_1a, norm_condition ~ altruistic_center, at = at_list, CIs = TRUE, xlab = "Altruistic Values (centered)", ylab = "Consumer Intentions")
```

* Altruistic values was a non-significant predictor of consumer intentions in the **control norm**, **descriptive norm**, **convention**, and **social norm** conditions.

* Altruistic values was a significant, positive predictor of consumer intentions in the **moral norm** condition.


Is the slope of the relationship between altruistic values & consumer intentions stronger in any one of the norm conditions compared to the others?

```{r}
emtrends(full_model_1a, pairwise~norm_condition, var = "altruistic_center", adjust = "none")
```


Second, relationship between altruistic values & consumer intentions for each framing condition:
```{r}
emtrends(full_model_1a, ~framing_condition, var = "altruistic_center", adjust = "none")

# On a single graph
at_list <- list(altruistic_center = seq(-5.4, 1, by = 1))

emmip(full_model_1a, framing_condition ~ altruistic_center, at = at_list, CIs = TRUE, xlab = "Altruistic Values (centered)", ylab = "Consumer Intentions")

# Separate graph for each norm
emmip(full_model_1a, ~ altruistic_center | framing_condition, at = at_list, CIs = TRUE, xlab = "Altruistic Values (centered)", ylab = "Consumer Intentions")
```

* Altruistic values are positively, but non-significantly, related to consumer intentions in each framing condition.


Is the slope of the relationship between altruistic values & consumer intentions stronger in any one of the framing conditions compared to the others?

```{r}
emtrends(full_model_1a, pairwise~framing_condition, var = "altruistic_center", adjust = "none")
```


Third, interaction between altruistic values, framing, & norm condition:
```{r}
emtrends(full_model_1a, ~norm_condition | framing_condition, var = "altruistic_center", adjust = "none")

# Separate graph for each framing condition
at_list <- list(altruistic_center = seq(-5.4, 1, by = 1))

emmip(full_model_1a, norm_condition ~ altruistic_center | framing_condition, at = at_list, CIs = TRUE, xlab = "Altruistic Values (centered)", ylab = "Consumer Intentions")
```

* In the control framing condition, altruistic values were significantly, positively related to consumer intentions in the **social norm** and **moral norm** conditions, but non-significantly related in the **control norm**, **descriptive norm**, and **convention** conditions.

* In the pro-environmental framing condition, altruistic values were not significantly related to consumer intentions in any of the norm conditions.

* In the self-enhancing framing condition, altruistic values were significantly, positively related to consumer intentions in the **moral norm** condition, but non-significantly related in all other norm conditions.



### Egoistic Values

First, relationship between egoistic values & consumer intentions for each norm condition:
```{r}
emtrends(full_model_1a, ~norm_condition, var = "egoistic_center", adjust = "none")

# On a single graph
at_list <- list(egoistic_center = seq(-3.6, 2.2, by = 1))

emmip(full_model_1a, norm_condition ~ egoistic_center, at = at_list, CIs = TRUE, xlab = "Egoistic Values (centered)", ylab = "Consumer Intentions")
```

* Egoistic values were a significant, negative predictor of consumer intentions within each norm condition


Is the slope of the relationship between egoistic values & consumer intentions stronger in any one of the norm conditions compared to the others?

```{r}
emtrends(full_model_1a, pairwise~norm_condition, var = "egoistic_center", adjust = "none")
```

No, the difference between any two slopes was not significant.



Second, relationship between egoistic values & consumer intentions for each framing condition:
```{r}
emtrends(full_model_1a, ~framing_condition, var = "egoistic_center", adjust = "none")

# On a single graph
at_list <- list(egoistic_center = seq(-3.6, 2.2, by = 1))

emmip(full_model_1a, framing_condition ~ egoistic_center, at = at_list, CIs = TRUE, xlab = "Egoistic Values (centered)", ylab = "Consumer Intentions")
```

* Egoistic values were a significant, negative predictor of consumer intentions within each framing condition


Is the slope of the relationship between egoistic values & consumer intentions stronger in any one of the framing conditions compared to the others?

```{r}
emtrends(full_model_1a, pairwise~framing_condition, var = "egoistic_center", adjust = "none")
```

No, the difference between any two slopes was not significant.




Third, interaction between egoistic values, framing, & norm condition:
```{r}
emtrends(full_model_1a, ~norm_condition | framing_condition, var = "egoistic_center", adjust = "none")

# Separate graph for each framing condition
at_list <- list(egoistic_center = seq(-3.6, 2.2, by = 1))

emmip(full_model_1a, norm_condition ~ egoistic_center | framing_condition, at = at_list, CIs = TRUE, xlab = "Egoistic Values (centered)", ylab = "Consumer Intentions")
```

* In the control framing condition, egoistic values were *not* significantly related to consumer intentions in the **control norm** or **moral norm** conditions (but were signifcantly, negatively related to consumer intentions in the other norm conditions).

* In the pro-environmental framing condition, egoistic values were *not* significantly related to consumer intentions in the **descriptive norm**, **convention**, **social norm**, and **moral norm** conditions (but were still significantly, negatively related in the control norm condition).

* In the self-enhancing framing condition, egoistic values were *not* significantly related to consumer intentions in the **control norm**, **descriptive norm** and **social norm** conditions (but were still significantly, negatively related in the convention & moral norm conditions).

  
  



### Hedoninc Values


First, relationship between hedonic values & consumer intentions for each norm condition:
```{r}
emtrends(full_model_1a, ~norm_condition, var = "hedonic_center", adjust = "none")


# On a single graph
at_list <- list(hedonic_center = seq(-5.2, 1.2, by = 1))

emmip(full_model_1a, norm_condition ~ hedonic_center, at = at_list, CIs = TRUE, xlab = "Hedonic Values (centered)", ylab = "Consumer Intentions")
```

* Hedonic values were not significantly related to consumer intentions in any norm condition except for the moral norm condition in which they were significantly, negatively related to consumer intentions.


Is the slope of the relationship between hedonic values & consumer intentions stronger in any one of the norm conditions compared to the others?

```{r}
emtrends(full_model_1a, pairwise~norm_condition, var = "hedonic_center", adjust = "none")
```


Second, relationship between hedonic values & consumer intentions for each framing condition:
```{r}
emtrends(full_model_1a, ~framing_condition, var = "hedonic_center", adjust = "none")

# On a single graph
at_list <- list(hedonic_center = seq(-5.2, 1.2, by = 1))

emmip(full_model_1a, framing_condition ~ hedonic_center, at = at_list, CIs = TRUE, xlab = "Hedonic Values (centered)", ylab = "Consumer Intentions")
```

* Hedonic values were non-significantly, negatively related to consumer intentions in all framing conditions.


Is the slope of the relationship between hedonic values & consumer intentions stronger in any one of the framing conditions compared to the others?

```{r}
emtrends(full_model_1a, pairwise~framing_condition, var = "hedonic_center", adjust = "none")
```


Third, interaction between hedonic values, framing, & norm condition:
```{r}
emtrends(full_model_1a, ~norm_condition | framing_condition, var = "hedonic_center", adjust = "none")

# Separate graph for each framing condition
at_list <- list(hedonic_center = seq(-5.2, 1.2, by = 1))

emmip(full_model_1a, norm_condition ~ hedonic_center | framing_condition, at = at_list, CIs = TRUE, xlab = "Hedonic Values (centered)", ylab = "Consumer Intentions")
```

* In the control framing condition, hedonic values were not significantly related to consumer intentions in any norm condition.

* In the pro-environmental framing condition, hedonic values were not significantly related to consumer intentions in any norm condition.

* In the self-enhancing framing condition, hedonic values were not significantly related to consumer intentions in any norm condition except for the moral norm condition in which they were significantly, related related.



### Ingroup Identification Interactions

>>H5: There will be a two-way interaction between ingroup identification and norm condition.

In the overall analysis, there was no significant two-way interaction between ingroup identification & framing condition or between ingroup identification & norm condition.


First, relationship between ingroup identification & consumer intentions for each norm condition:
```{r}
emtrends(full_model_1a, ~norm_condition, var = "ingroup_identification_center", adjust = "none")


# On a single graph
at_list <- list(ingroup_identification_center = seq(-3.8, 2.6, by = 1))

emmip(full_model_1a, norm_condition ~ ingroup_identification_center, at = at_list, CIs = TRUE, xlab = "Ingroup Identification (centered)", ylab = "Consumer Intentions")
```

* Ingroup identification was not significantly related to consumer intentions in any of the norm conditions.


Is the slope of the relationship between ingroup idenitification & consumer intentions stronger in any one of the norm conditions compared to the others?

```{r}
emtrends(full_model_1a, pairwise~norm_condition, var = "ingroup_identification_center", adjust = "none")
```



Second, relationship between ingroup identification & consumer intentions for each framing condition:
```{r}
emtrends(full_model_1a, ~framing_condition, var = "ingroup_identification_center", adjust = "none")

# On a single graph
at_list <- list(ingroup_identification_center = seq(-3.8, 2.6, by = 1))

emmip(full_model_1a, framing_condition ~ ingroup_identification_center, at = at_list, CIs = TRUE, xlab = "Ingroup Identification (centered)", ylab = "Consumer Intentions")
```

* Ingroup identification was non-significantly, negatively related to consumer intentions in all framing conditions.



Is the slope of the relationship between ingroup idenitification & consumer intentions stronger in any one of the framing conditions compared to the others?

```{r}
emtrends(full_model_1a, pairwise~framing_condition, var = "ingroup_identification_center", adjust = "none")
```



>> Exploratory RQ1: Is there a three-way interaction between ingroup identification, framing, and norm condition?

Third, interaction between ingroup identification, framing, & norm condition:
```{r}
emtrends(full_model_1a, ~norm_condition | framing_condition, var = "ingroup_identification_center", adjust = "tukey")

# Separate graph for each framing condition
at_list <- list(ingroup_identification_center = seq(-3.8, 2.6, by = 1))

emmip(full_model_1a, norm_condition ~ ingroup_identification_center | framing_condition, at = at_list, CIs = TRUE, xlab = "Ingroup Identification (centered)", ylab = "Consumer Intentions")
```

* In the control framing condition, ingroup identification was non-significantly related to consumer intentions in all norm conditions.

* In the pro-environmental framing condition, ingroup identification was non-significantly related to consumer intentions in all norm conditions.

* In the self-enhancing framing condition, ingroup identification was non-significantly related to consumer intentions in all norm conditions except for the moral norm condition in which ingroup identification was significantly, negatively related to consumer intentions.


### All cells compared to control

>> Exploratory RQ2: Which combination of framing and norm condition produced the strongest reductions in consumer intentions compared to the control condition?

```{r}
emmeans(full_model_1a, pairwise ~ norm_condition*framing_condition, adjust = "tukey")


emmip(full_model_1a, framing_condition ~ norm_condition, CIs = TRUE, xlab = "Norm Condition", ylab = "Consumer Intentions")
```

There are no significant differences between the control norm/control framing condition and any of the other combinations of framing/norm conditions.




### Gender Interactions (exploratory)


Three-way Gender Interactions:
```{r}
emmeans(full_model_1a, ~ norm_condition*Gender*framing_condition, adjust = "none")

emmip(full_model_1a, Gender ~ norm_condition | framing_condition, CIs = FALSE, xlab = "Norm Condition", ylab = "Consumer Intentions")

emmip(full_model_1a, Gender ~ framing_condition | norm_condition, CIs = FALSE, xlab = "Norm Condition", ylab = "Consumer Intentions")

```



# Logistic Analysis (DV = Consumer Behaviors)

Consumer Behaviors:

* 0 = New Clothing
* 1 = Secondhand Clothing


## Running Model
```{r}
log_model <- glm(consumer_behaviors ~ framing_condition*norm_condition*biospheric_center + framing_condition*norm_condition*altruistic_center + framing_condition*norm_condition*egoistic_center + framing_condition*norm_condition*hedonic_center + framing_condition*norm_condition*ingroup_identification_center + self_deceptive_center + impress_manag_center + clothing_interest_center + Gender + Age_center, data = data_R, family = "binomial")
```


## Model Summary

### ANOVA Output
```{r anova table consumer intentions log regr}
anova(log_model) %>%
  knitr::kable(digits = 3)
```

### Regression Summary
```{r include = FALSE}
log_summ <- summary(log_model)
log_summ
```

* 171 observations deleted due to missingness

```{r}
log_summ$coefficients %>%
  knitr::kable(digits = c(2, 2, 2, 3))
```


### Odds Ratios

Converting log odds estimates to odds ratios:
```{r}
exp(coef(log_model)) %>%
  knitr::kable(digits = 2)

# with CIs
#exp(cbind(OR = coef(log_model), confint(log_model))) %>%
  #knitr::kable(digits = 2)
```




## Assessing Overall Effects

Effect of framing condition
```{r}
wald.test(b = coef(log_model), Sigma = vcov(log_model), Terms = 2:3)
```

Effect of framing condition
```{r}
wald.test(b = coef(log_model), Sigma = vcov(log_model), Terms = 4:7)
```

Framing X Norm Interaction
```{r}
wald.test(b = coef(log_model), Sigma = vcov(log_model), Terms = 17:24)
```

Framing X Biospheric Interaction
```{r}
wald.test(b = coef(log_model), Sigma = vcov(log_model), Terms = 25:26)
```

Norm X Biospheric Interaction
```{r}
wald.test(b = coef(log_model), Sigma = vcov(log_model), Terms = 27:30)
```



## Simple Effects

### Framing Condition

>>H1: Consumer intentions/behaviors will be lower in the self-enhancing framing than in the pro-environmental or control framing conditions.

```{r}
# on the log odds scale
emmeans(log_model, pairwise ~ framing_condition, adjust = "none")

emmip(log_model, ~ framing_condition, CIs = TRUE, xlab = "Framing Condition", ylab = "log odds(Consumer Behaviors)")


# using probabilities
emmeans(log_model, pairwise ~ framing_condition, adjust = "none", regrid = "response")

emmip(log_model, ~ framing_condition, CIs = TRUE, regrid = "response", xlab = "Framing Condition", ylab = "Consumer Behaviors")
```



### Norm Condition

>>H2: Consumer intentions/behaviors will be lower in each norm condition compared to the control norm condition.

```{r}
# on the log odds scale
emmeans(log_model, pairwise ~ norm_condition, adjust = "none")

emmip(log_model, ~ norm_condition, CIs = TRUE, xlab = "Norm Condition", ylab = "log odds(Consumer Behaviors)")


# using probabilities
emmeans(log_model, pairwise ~ norm_condition, adjust = "none", regrid = "response")

emmip(log_model, ~ norm_condition, CIs = TRUE, regrid = "response", xlab = "Framing Condition", ylab = "Consumer Behaviors")
```


### Framing X Norm

>>H3: There will be a two-way interaction between framing & norm condition such that the effect of each norm will be stronger in the self-enhancing framing than in the pro-environmental or control framing conditions.


```{r}
# on the log odds scale
emmeans(log_model, pairwise ~ norm_condition | framing_condition, adjust = "none")

emmip(log_model, framing_condition ~ norm_condition, CIs = FALSE, xlab = "Norm Condition", ylab = "log odds(Consumer Behaviors)")


# using probabilities
emmeans(log_model, pairwise ~ norm_condition | framing_condition, adjust = "none", regrid = "response")

emmip(log_model, framing_condition ~ norm_condition, CIs = FALSE, regrid = "response", xlab = "Framing Condition", ylab = "Consumer Behaviors")
```




